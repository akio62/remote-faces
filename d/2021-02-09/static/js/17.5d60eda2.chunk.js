(this["webpackJsonpremote-faces-web"]=this["webpackJsonpremote-faces-web"]||[]).push([[17],{1244:function(e,t,n){},1254:function(e,t,n){"use strict";n.r(t),n.d(t,"VideoShare",(function(){return v}));var c=n(5),r=n(0),a=n(2),u=n.n(a),i=(n(1244),n(1)),s=n.n(i),o=n(98),d=n(97),b=n(3),j=n(319),f=n(111),l=n(317),O=n(191),m=u.a.memo((function(e){var t=e.nickname,n=e.stream,c=Object(a.useRef)(null);return Object(a.useEffect)((function(){n&&c.current&&(c.current.srcObject=n)}),[n]),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"VideoShare-nickname",children:t}),Object(r.jsx)("video",{className:"VideoShare-video",ref:c,autoPlay:!0,muted:!0})]})})),v=u.a.memo((function(e){var t=e.roomId,n=e.userId,u=e.nickname,i=Object(l.b)(),v=Object(a.useState)(),h=Object(c.a)(v,2),p=h[0],S=h[1],x=Object(a.useState)(!1),k=Object(c.a)(x,2),w=k[0],E=k[1],V=function(e,t,n,r,u){var i=Object(a.useState)(null),l=Object(c.a)(i,2),O=l[0],m=l[1],v=Object(a.useState)({}),h=Object(c.a)(v,2),p=h[0],S=h[1],x=Object(a.useRef)([]);Object(a.useEffect)((function(){return function(){x.current.forEach((function(e){return e()}))}}),[]);var k=Object(a.useCallback)(function(){var e=Object(b.a)(s.a.mark((function e(t,n){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S((function(e){return Object(d.a)(Object(d.a)({},e),{},Object(o.a)({},n.userId,new MediaStream([t])))})),c=function(){S((function(e){return Object(d.a)(Object(d.a)({},e),{},Object(o.a)({},n.userId,null))}))},t.addEventListener("ended",c),x.current.push((function(){t.removeEventListener("ended",c)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]),w=Object(f.c)(e,t,k,"cameraVideo");return Object(a.useEffect)((function(){var e=null;return n&&w&&Object(b.a)(s.a.mark((function t(){var n,a,i,o,d;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(j.b)(u);case 2:n=t.sent,a=n.stream.getVideoTracks(),i=Object(c.a)(a,1),o=i[0],d=w(o),m(n.stream),e=function(){d(),n.dispose(),m(null),r(!1)},o.addEventListener("ended",(function(){e&&e(),e=null}));case 8:case"end":return t.stop()}}),t)})))(),function(){e&&e()}}),[e,u,n,r,w]),{videoStream:O,videoStreamMap:p}}(t,n,w,E,p),y=V.videoStream,I=V.videoStreamMap,N=Object(O.a)(t,n),g=(y?1:0)+Object.values(I).filter((function(e){return e})).length;return Object(r.jsxs)("div",{className:"VideoShare-container",children:[Object(r.jsxs)("div",{children:["Select Camera:"," ",Object(r.jsx)("select",{value:p,onChange:function(e){return S(e.target.value)},children:i.map((function(e){return Object(r.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)}))})]}),Object(r.jsx)("button",{type:"button",onClick:function(){return E(!w)},children:w?"Stop video share":"Start video share"}),Object(r.jsxs)("div",{className:"VideoShare-body",style:{gridTemplateColumns:"repeat(".concat(Math.ceil(Math.sqrt(g)),", 1fr)")},children:[y&&Object(r.jsx)(m,{nickname:u,stream:y}),Object.keys(I).map((function(e){var t=I[e];return t?Object(r.jsx)(m,{nickname:N[e]||"No Name",stream:t},e):null}))]})]})}));t.default=v}}]);
//# sourceMappingURL=17.5d60eda2.chunk.js.map