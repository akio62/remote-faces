(this["webpackJsonpremote-faces-web"]=this["webpackJsonpremote-faces-web"]||[]).push([[16],{1242:function(e,t,n){},1251:function(e,t,n){"use strict";n.r(t),n.d(t,"ScreenShare",(function(){return O}));var r=n(5),c=n(0),a=n(2),u=n.n(a),s=(n(1242),n(1)),i=n.n(s),o=n(98),f=n(97),b=n(3),j=function(){var e=Object(b.a)(i.a.mark((function e(){var t,n,c,a,u,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={video:!0},e.next=4,navigator.mediaDevices.getDisplayMedia(t);case 4:return n=e.sent,c=n.getVideoTracks(),a=Object(r.a)(c,1),u=a[0],s=function(){u.stop()},e.abrupt("return",{stream:n,dispose:s});case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),d=n(111),l=n(191),m=u.a.memo((function(e){var t=e.nickname,n=e.stream,r=Object(a.useRef)(null);return Object(a.useEffect)((function(){n&&r.current&&(r.current.srcObject=n)}),[n]),Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:"ScreenShare-nickname",children:t}),Object(c.jsx)("video",{className:"ScreenShare-video",ref:r,autoPlay:!0,muted:!0})]})})),O=u.a.memo((function(e){var t=e.roomId,n=e.userId,u=e.nickname,s=Object(a.useState)(!1),O=Object(r.a)(s,2),p=O[0],v=O[1],h=function(e,t,n,c){var u=Object(a.useState)(null),s=Object(r.a)(u,2),l=s[0],m=s[1],O=Object(a.useState)({}),p=Object(r.a)(O,2),v=p[0],h=p[1],S=Object(a.useRef)([]);Object(a.useEffect)((function(){return function(){S.current.forEach((function(e){return e()}))}}),[]);var k=Object(a.useCallback)(function(){var e=Object(b.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(o.a)({},n.userId,new MediaStream([t])))})),r=function(){h((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(o.a)({},n.userId,null))}))},t.addEventListener("ended",r),S.current.push((function(){t.removeEventListener("ended",r)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]),x=Object(d.c)(e,t,k,"screenVideo");return Object(a.useEffect)((function(){var e=null;return n&&x&&Object(b.a)(i.a.mark((function t(){var n,a,u,s,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j();case 2:if(n=t.sent){t.next=6;break}return c(!1),t.abrupt("return");case 6:a=n.stream.getVideoTracks(),u=Object(r.a)(a,1),s=u[0],o=x(s),m(n.stream),e=function(){o(),n.dispose(),m(null),c(!1)},s.addEventListener("ended",(function(){e&&e(),e=null}));case 11:case"end":return t.stop()}}),t)})))(),function(){e&&e()}}),[e,n,c,x]),{screenStream:l,screenStreamMap:v}}(t,n,p,v),S=h.screenStream,k=h.screenStreamMap,x=Object(l.a)(t,n);return Object(c.jsxs)("div",{className:"ScreenShare-container",children:[Object(c.jsx)("button",{type:"button",onClick:function(){return v(!p)},children:p?"Stop screen share":"Start screen share"}),Object(c.jsxs)("div",{className:"ScreenShare-body",children:[S&&Object(c.jsx)(m,{nickname:u,stream:S}),Object.keys(k).map((function(e){var t=k[e];return t?Object(c.jsx)(m,{nickname:x[e]||"No Name",stream:t},e):null}))]})]})}));t.default=O}}]);
//# sourceMappingURL=16.ea04a762.chunk.js.map