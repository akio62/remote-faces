/*! For license information please see 21.25f72e90.chunk.js.LICENSE.txt */
(this["webpackJsonpremote-faces-web"]=this["webpackJsonpremote-faces-web"]||[]).push([[21],{520:function(t,e,r){!function(t){"use strict";var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,r)};function r(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}var i=function(){return(i=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t){function e(e,r){var i=this.constructor,o=t.call(this,e)||this;return o.__proto__=i.prototype,o.name=o.name="SGFSyntaxError",o.message=e||"There was an unspecified syntax error in the SGF",r&&(o.message+=" on line "+r.lineNo+", char "+r.charNo+":\n",o.message+="\t"+r.sgfString.split("\n")[r.lineNo-1]+"\n",o.message+="\t"+Array(r.charNo+1).join(" ")+"^"),o}return r(e,t),e}(Error),n="A".charCodeAt(0),s="Z".charCodeAt(0),a=" ".charCodeAt(0);function h(t){if(!t)return!1;var e=t.charCodeAt(0);return e>=n&&e<=s}var l,p=function(){function t(t){this.position=0,this.lineNo=1,this.charNo=0,this.sgfString=t}return t.prototype.currentChar=function(){for(;this.sgfString.charCodeAt(this.position)<=a;)this.nextChar();return this.sgfString[this.position]},t.prototype.nextChar=function(){return"\n"===this.sgfString[this.position]?(this.charNo=0,this.lineNo++):this.charNo++,this.position++,this.sgfString[this.position]},t.prototype.processChar=function(t){if(this.currentChar()!==t)throw new o("Unexpected character "+this.currentChar()+". Character "+t+" was expected.",this);return this.nextChar()},t.prototype.parsePropertyValue=function(t){if(!t||"["===this.currentChar()){for(var e="",r=this.processChar("[");"]"!==r;){if(!r)throw new o("End of SGF inside of property",this);if("\\"===r){if(!(r=this.nextChar()))throw new o("End of SGF inside of property",this);if("\n"===r)continue}e+=r,r=this.nextChar()}return this.processChar("]"),e}},t.prototype.parsePropertyIdent=function(){var t="",e=this.currentChar();if(!h(e))throw new o("Property identifier must consists from upper case letters.",this);for(t+=e;(e=this.nextChar())&&h(e);)t+=e;return t},t.prototype.parsePropertyValues=function(){var t=[],e=this.parsePropertyValue();for(e&&t.push(e);e=this.parsePropertyValue(!0);)t.push(e);return t},t.prototype.parseProperty=function(){if(h(this.currentChar()))return[this.parsePropertyIdent(),this.parsePropertyValues()]},t.prototype.parseNode=function(){this.processChar(";");for(var t,e={};t=this.parseProperty();)e[t[0]]=t[1];return e},t.prototype.parseSequence=function(){var t=[];for(t.push(this.parseNode());";"===this.currentChar();)t.push(this.parseNode());return t},t.prototype.parseGameTree=function(){this.processChar("(");var t=this.parseSequence(),e=[];return"("===this.currentChar()&&(e=this.parseCollection()),this.processChar(")"),{sequence:t,children:e}},t.prototype.parseCollection=function(){var t=[];for(t.push(this.parseGameTree());"("===this.currentChar();)t.push(this.parseGameTree());return t},t}(),c=function(){function t(t){this.zIndex=0,this.opacity=1,this.type=t}return t}(),u=function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this,e)||this;return o.scaleX=1,o.scaleY=1,o.rotate=0,o.x=r,o.y=i,o}return r(e,t),e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setScale=function(t){this.scaleX=t,this.scaleY=t},e}(c);(l=t.Color||(t.Color={}))[l.BLACK=1]="BLACK",l[l.B=1]="B",l[l.WHITE=-1]="WHITE",l[l.W=-1]="W",l[l.EMPTY=0]="EMPTY",l[l.E=0]="E";var d=function(e){function i(r,i,o,n){void 0===i&&(i=0),void 0===o&&(o=0),void 0===n&&(n=t.Color.E);var s=e.call(this,r,i,o)||this;return s.variation=n,s}return r(i,e),i}(u),f=function(t){function e(e,r,i,o){void 0===r&&(r=0),void 0===i&&(i=0);var n=t.call(this,"LB",r,i,o)||this;return n.text=e,n}return r(e,t),e}(d),m=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.start=r,o.end=i,o}return r(e,t),e}(c),y=function(){function t(){this._events={}}return t.prototype.on=function(t,e){this._events[t]=this._events[t]||[],this._events[t].push(e)},t.prototype.off=function(t,e){this._events[t]&&(null==e&&(this._events[t]=[]),this._events[t]=this._events[t].filter((function(t){return t!==e})))},t.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._events[t]&&this._events[t].forEach((function(t){return t.apply(void 0,e)}))},t}();function b(t,e){var r={},i=Object.keys(t);return i.forEach((function(i){var o=e[i],n=t[i];null==o||o.constructor!==Object||Array.isArray(o)||null==n?r[i]=void 0!==o?o:n:r[i]=b(n,o)})),Object.keys(e).forEach((function(t){-1===i.indexOf(t)&&(r[t]=e[t])})),r}var g={stoneSize:.47,marginSize:.25,font:"calibri",backgroundColor:"#CEB053",backgroundImage:"",markupBlackColor:"rgba(255,255,255,0.9)",markupWhiteColor:"rgba(0,0,0,0.7)",markupNoneColor:"rgba(0,0,0,0.7)",markupLineWidth:.05,shadowColor:"rgba(62,32,32,0.5)",shadowTransparentColor:"rgba(62,32,32,0)",shadowBlur:.25,shadowOffsetX:.07,shadowOffsetY:.13,grid:{linesWidth:.03,linesColor:"#654525",starColor:"#531",starSize:.07},coordinates:{color:"#531",bold:!1}},v={size:19,width:0,height:0,starPoints:{5:[{x:2,y:2}],7:[{x:3,y:3}],8:[{x:2,y:2},{x:5,y:2},{x:2,y:5},{x:5,y:5}],9:[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}],10:[{x:2,y:2},{x:7,y:2},{x:2,y:7},{x:7,y:7}],11:[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}],12:[{x:3,y:3},{x:8,y:3},{x:3,y:8},{x:8,y:8}],13:[{x:3,y:3},{x:9,y:3},{x:6,y:6},{x:3,y:9},{x:9,y:9}],14:[{x:3,y:3},{x:10,y:3},{x:3,y:10},{x:10,y:10}],15:[{x:3,y:3},{x:11,y:3},{x:7,y:7},{x:3,y:11},{x:11,y:11}],16:[{x:3,y:3},{x:12,y:3},{x:3,y:12},{x:12,y:12}],17:[{x:3,y:3},{x:8,y:3},{x:13,y:3},{x:3,y:8},{x:8,y:8},{x:13,y:8},{x:3,y:13},{x:8,y:13},{x:13,y:13}],18:[{x:3,y:3},{x:14,y:3},{x:3,y:14},{x:14,y:14}],19:[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}],20:[{x:3,y:3},{x:16,y:3},{x:3,y:16},{x:16,y:16}],21:[{x:3,y:3},{x:10,y:3},{x:17,y:3},{x:3,y:10},{x:10,y:10},{x:17,y:10},{x:3,y:17},{x:10,y:17},{x:17,y:17}]},viewport:{top:0,right:0,bottom:0,left:0},coordinates:!1,coordinateLabelsX:"ABCDEFGHJKLMNOPQRSTUVWXYZ",coordinateLabelsY:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],theme:g},C=function(t){function e(e,r){void 0===r&&(r={});var i=t.call(this)||this;return i.objects=[],i.element=e,i.config=b(v,r),i}return r(e,t),e.prototype.resize=function(){},e.prototype.redraw=function(){},e.prototype.addObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.addObject(t[e]);else this.hasObject(t)||this.objects.push(t)},e.prototype.updateObject=function(t){},e.prototype.removeObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.removeObject(t[e]);else{var r=this.objects.indexOf(t);-1!==r&&this.objects.splice(r,1)}},e.prototype.removeObjectsAt=function(t,e){var r=this;this.objects.forEach((function(i){i instanceof u&&i.x===t&&i.y===e&&r.removeObject(i)}))},e.prototype.removeAllObjects=function(){this.objects=[]},e.prototype.hasObject=function(t){return this.objects.indexOf(t)>=0},e.prototype.setWidth=function(t){this.config.width=t,this.config.height=0,this.resize()},e.prototype.setHeight=function(t){this.config.width=0,this.config.height=t,this.resize()},e.prototype.setDimensions=function(t,e){this.config.width=t,this.config.height=e,this.resize()},e.prototype.getViewport=function(){return this.config.viewport},e.prototype.setViewport=function(t){this.config.viewport=t},e.prototype.getSize=function(){return this.config.size},e.prototype.setSize=function(t){void 0===t&&(t=19),this.config.size=t},e.prototype.getCoordinates=function(){return this.config.coordinates},e.prototype.setCoordinates=function(t){this.config.coordinates=t},e}(y),E=function(){function t(t){this.board=t,this.init()}return t.prototype.init=function(){this.element=document.createElement("canvas"),this.element.style.position="absolute",this.element.style.width="100%",this.element.style.height="100%",this.context=this.element.getContext("2d"),this.context.scale(this.board.pixelRatio,this.board.pixelRatio),this.context.save(),this.board.boardElement.appendChild(this.element)},t.prototype.resize=function(t,e){var r=this.board.config.theme.linesShift;this.element.width=t,this.element.height=e,this.context.transform(1,0,0,1,r,r)},t.prototype.draw=function(t,e){var r=this;try{if(this.context.save(),e instanceof u){var i=this.board.getX(e.x),o=this.board.getY(e.y),n=this.board.fieldSize;this.context.transform(n*e.scaleX,0,0,n*e.scaleY,i,o),this.context.rotate(e.rotate),this.context.globalAlpha=e.opacity}else i=this.board.getX(0),o=this.board.getY(0),n=this.board.fieldSize,this.context.transform(n,0,0,n,i,o);var s=t(this.context,this.board.config,e);this.context.restore(),s&&s.then&&s.then((function(){r.board.redraw()}))}catch(a){console.error("Object couldn't be rendered. Error: "+a.message,e)}},t.prototype.clear=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.context.transform(1,0,0,1,this.board.config.theme.shadowOffsetX*this.board.fieldSize,this.board.config.theme.shadowOffsetY*this.board.fieldSize)},e}(E),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.drawGrid()},e.prototype.clear=function(){t.prototype.clear.call(this),this.drawGrid()},e.prototype.drawGrid=function(){var t,e=this.board.config.theme.grid;this.context.beginPath(),this.context.lineWidth=e.linesWidth*this.board.fieldSize,this.context.strokeStyle=e.linesColor;var r=Math.round(this.board.getX(0)),i=Math.round(this.board.getY(0)),o=Math.round((this.board.config.size-1)*this.board.fieldSize),n=Math.round((this.board.config.size-1)*this.board.fieldSize);this.context.strokeRect(r,i,o,n);for(var s=1;s<this.board.config.size-1;s++)t=Math.round(this.board.getX(s)),this.context.moveTo(t,i),this.context.lineTo(t,i+n),t=Math.round(this.board.getY(s)),this.context.moveTo(r,t),this.context.lineTo(r+o,t);if(this.context.stroke(),this.context.fillStyle=e.starColor,this.board.config.starPoints[this.board.config.size])for(var a in this.board.config.starPoints[this.board.config.size])this.context.beginPath(),this.context.arc(this.board.getX(this.board.config.starPoints[this.board.config.size][a].x),this.board.getY(this.board.config.starPoints[this.board.config.size][a].y),e.starSize*this.board.fieldSize,0,2*Math.PI,!0),this.context.fill();this.board.config.coordinates&&this.drawCoordinates()},e.prototype.drawCoordinates=function(){var t,e=this.board.config.theme.coordinates;this.context.fillStyle=e.color,this.context.textBaseline="middle",this.context.textAlign="center",this.context.font=(e.bold?"bold ":"")+this.board.fieldSize/2+"px "+(this.board.config.theme.font||"");for(var r=this.board.getX(-.75),i=this.board.getX(this.board.config.size-.25),o=this.board.getY(-.75),n=this.board.getY(this.board.config.size-.25),s=this.board.config.coordinateLabelsX,a=this.board.config.coordinateLabelsY,h=0;h<this.board.config.size;h++)t=this.board.getY(h),this.context.fillText(s[h],r,t),this.context.fillText(s[h],i,t),t=this.board.getX(h),this.context.fillText(a[h],t,o),this.context.fillText(a[h],t,n);this.context.fillStyle="black"},e}(E),S=function(){function t(t){void 0===t&&(t={}),this.params=t}return t}(),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.shadow=function(t,e){var r=e.theme.stoneSize,i=e.theme.shadowBlur,o=Math.max(r-r*i,1e-5),n=r+1/7*r*i,s=t.createRadialGradient(0,0,o,0,0,n);s.addColorStop(0,e.theme.shadowColor),s.addColorStop(1,e.theme.shadowTransparentColor),t.beginPath(),t.fillStyle=s,t.arc(0,0,n,0,2*Math.PI,!0),t.fill()},e}(S),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e){var r=e.theme.stoneSize;t.beginPath(),t.fillStyle="#000",t.arc(0,0,r,0,2*Math.PI,!0),t.fill();var i=t.createRadialGradient(.4*r,.4*r,0,.5*r,.5*r,r);i.addColorStop(0,"rgba(32,32,32,1)"),i.addColorStop(1,"rgba(0,0,0,0)"),t.beginPath(),t.fillStyle=i,t.arc(0,0,r,0,2*Math.PI,!0),t.fill(),(i=t.createRadialGradient(-.4*r,-.4*r,.05*r,-.5*r,-.5*r,1.5*r)).addColorStop(0,"rgba(64,64,64,1)"),i.addColorStop(1,"rgba(0,0,0,0)"),t.beginPath(),t.fillStyle=i,t.arc(0,0,r,0,2*Math.PI,!0),t.fill()},e}(A),M=Math.ceil(9999999*Math.random()),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e,r){var i=e.theme.stoneSize;t.beginPath(),t.fillStyle="#aaa",t.arc(0,0,i,0,2*Math.PI,!0),t.fill();var o=M%(3+r.x*e.size+r.y)%3,n=e.size*e.size+r.x*e.size+r.y,s=2/n*(M%n);0===o?this.drawShell({ctx:t,x:0,y:0,radius:i,angle:s,lines:[.1,.12,.11,.1,.09,.09,.09,.09],factor:.25,thickness:1.75}):1===o?this.drawShell({ctx:t,x:0,y:0,radius:i,angle:s,lines:[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],factor:.2,thickness:1.5}):this.drawShell({ctx:t,x:0,y:0,radius:i,angle:s,lines:[.12,.14,.13,.12,.12,.12],factor:.3,thickness:2});var a=t.createRadialGradient(-2*i/5,-2*i/5,i/3,-i/5,-i/5,5*i/5);a.addColorStop(0,"rgba(255,255,255,0.9)"),a.addColorStop(1,"rgba(255,255,255,0)"),t.beginPath(),t.fillStyle=a,t.arc(0,0,i,0,2*Math.PI,!0),t.fill()},e.prototype.drawShell=function(t){for(var e=t.angle,r=t.angle,i=0;i<t.lines.length;i++)e+=t.lines[i],r-=t.lines[i],this.drawShellLine(t.ctx,t.x,t.y,t.radius,e,r,t.factor,t.thickness)},e.prototype.drawShellLine=function(t,e,r,i,o,n,s,a){t.strokeStyle="rgba(64,64,64,0.2)",t.lineWidth=i/30*a,t.beginPath();var h,l,p,c,u=.9*i,d=e+u*Math.cos(o*Math.PI),f=r+u*Math.sin(o*Math.PI),m=e+u*Math.cos(n*Math.PI),y=r+u*Math.sin(n*Math.PI);m>d?(h=(y-f)/(m-d),l=Math.atan(h)):m===d?l=Math.PI/2:(h=(y-f)/(m-d),l=Math.atan(h)-Math.PI);var b=s*u,g=d+(p=Math.sin(l)*b),v=f-(c=Math.cos(l)*b),C=m+p,E=y-c;t.moveTo(d,f),t.bezierCurveTo(g,v,C,E,m,y),t.stroke()},e}(A),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e){var r=e.theme.stoneSize,i=t.createRadialGradient(-2*r/5,-2*r/5,1,-r/5,-r/5,4*r/5);i.addColorStop(0,"#666"),i.addColorStop(1,"#000"),t.beginPath(),t.fillStyle=i,t.arc(0,0,r,0,2*Math.PI,!0),t.fill()},e}(A),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e){var r=e.theme.stoneSize,i=t.createRadialGradient(-2*r/5,-2*r/5,r/3,-r/5,-r/5,5*r/5);i.addColorStop(0,"#fff"),i.addColorStop(1,"#aaa"),t.beginPath(),t.fillStyle=i,t.arc(0,0,r,0,2*Math.PI,!0),t.fill()},e}(A),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e){var r=e.theme.stoneSize,i=t.createRadialGradient(-2*r/5,-2*r/5,1*r/5,-r/5,-r/5,4*r/5);i.addColorStop(0,"#111"),i.addColorStop(1,"#000"),t.beginPath(),t.fillStyle=i,t.arc(0,0,r,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.lineWidth=r/6,t.strokeStyle="#ccc",t.arc(-r/8,-r/8,r/2,Math.PI,1.5*Math.PI),t.stroke()},e}(A),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e){var r=e.theme.stoneSize,i=t.createRadialGradient(-2*r/5,-2*r/5,2*r/5,-r/5,-r/5,4*r/5);i.addColorStop(0,"#fff"),i.addColorStop(1,"#ddd"),t.beginPath(),t.fillStyle=i,t.arc(0,0,r,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.lineWidth=r/6,t.strokeStyle="#999",t.arc(r/8,r/8,r/2,0,Math.PI/2,!1),t.stroke()},e}(A),z=function(t){function e(e){return t.call(this,{color:e})||this}return r(e,t),e.prototype.stone=function(t,e){var r=e.theme.stoneSize,i=e.theme.markupLineWidth;t.fillStyle=this.params.color,t.beginPath(),t.arc(0,0,r-i/2,0,2*Math.PI,!0),t.fill(),t.lineWidth=i,t.strokeStyle="black",t.stroke()},e}(S),L=function(t){function e(e,r){var i=t.call(this)||this;return i.fallback=r,i.randSeed=Math.ceil(9999999*Math.random()),i.images={},i.paths=e,i}return r(e,t),e.prototype.loadImage=function(t){return new Promise((function(e,r){var i=new Image;i.onload=function(){e(i)},i.onerror=function(){r()},i.src=t}))},e.prototype.stone=function(t,e,r){var i=this,o=this.paths.length;if(o){var n=e.theme.stoneSize,s=this.randSeed%(o+r.x*e.size+r.y)%o;if(!this.images[this.paths[s]]){this.fallback.stone(t,e,r);var a=this.paths[s];return this.loadImage(a).then((function(t){i.images[a]=t})).catch((function(){i.paths=i.paths.filter((function(t){return t!==a}))}))}t.drawImage(this.images[this.paths[s]],-n,-n,2*n,2*n)}else this.fallback.stone(t,e,r)},e}(A),B=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),i.prototype.grid=function(e,r,i){i.variation===t.Color.E&&e.clearRect(-r.theme.stoneSize,-r.theme.stoneSize,2*r.theme.stoneSize,2*r.theme.stoneSize)},i.prototype.getColor=function(e,r){return this.params.color?this.params.color:r.variation===t.Color.B?e.theme.markupBlackColor:r.variation===t.Color.W?e.theme.markupWhiteColor:e.theme.markupNoneColor},i}(S),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e,r){t.strokeStyle=this.getColor(e,r),t.lineWidth=this.params.lineWidth||e.theme.markupLineWidth,t.shadowBlur=10,t.shadowColor=t.strokeStyle,t.beginPath(),this.drawShape(t),t.stroke(),this.params.fillColor&&(t.fillStyle=this.params.fillColor,t.fill())},e}(B),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.drawShape=function(t){t.arc(0,0,.25,0,2*Math.PI,!0)},e}(I),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.drawShape=function(t){t.rect(-.25,-.25,.5,.5)},e}(I),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.drawShape=function(t){t.moveTo(0,-.25),t.lineTo(-.25,.166666),t.lineTo(.25,.166666),t.closePath()},e}(I),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e,r){var i=this.params.font||e.theme.font||"";t.fillStyle=this.getColor(e,r),t.shadowBlur=10,t.shadowColor=t.fillStyle;var o=.5;1===r.text.length?o=.75:2===r.text.length&&(o=.6),t.beginPath(),t.textBaseline="middle",t.textAlign="center",t.font=o+"px "+i,t.fillText(r.text,0,.02+.08*(o-.5),1)},e}(B),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t){t.fillStyle=this.params.color,t.shadowBlur=10,t.shadowColor=t.fillStyle,t.beginPath(),t.arc(0,0,.15,0,2*Math.PI,!0),t.fill()},e}(S),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.drawShape=function(t){t.moveTo(-.2,-.2),t.lineTo(.2,.2),t.moveTo(.2,-.2),t.lineTo(-.2,.2)},e}(I),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e,r){t.strokeStyle=this.params.color?this.params.color:e.theme.markupNoneColor,t.lineWidth=this.params.lineWidth||e.theme.markupLineWidth,t.shadowBlur=10,t.shadowColor=t.strokeStyle,t.beginPath(),t.moveTo(r.start.x,r.start.y),t.lineTo(r.end.x,r.end.y),t.stroke()},e}(S),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t,e,r){t.strokeStyle=this.params.color?this.params.color:e.theme.markupNoneColor,t.fillStyle=t.strokeStyle,t.lineWidth=this.params.lineWidth||e.theme.markupLineWidth,t.shadowBlur=10,t.shadowColor=t.strokeStyle;var i=r.start.x,o=r.start.y,n=r.end.x,s=r.end.y,a=Math.sqrt((n-i)*(n-i)+(s-o)*(s-o)),h=function(t){return i+t*(n-i)},l=function(t){return o+t*(s-o)},p=1/a/2.5,c=h(1-p),u=l(1-p),d=function(t){return c+t*(s-o)},f=function(t){return u+t*(i-n)},m=.1;t.beginPath(),t.arc(i,o,m,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.moveTo(h(1/a*m),l(1/a*m)),t.lineTo(c,u),t.stroke(),t.beginPath(),t.moveTo(d(-p/1.75),f(-p/1.75)),t.lineTo(d(p/1.75),f(p/1.75)),t.lineTo(n,s),t.closePath(),t.fill()},e}(S),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.stone=function(t){t.fillStyle=this.params.color,t.fillRect(-.5,-.5,1,1)},e}(S),K=Object.freeze({DrawHandler:S,ShellStoneBlack:N,ShellStoneWhite:k,GlassStoneBlack:O,GlassStoneWhite:P,PaintedStoneBlack:_,PaintedStoneWhite:T,SimpleStone:z,RealisticStone:L,Circle:R,Square:j,Triangle:W,Label:G,Dot:V,XMark:H,Line:D,Arrow:F,Stone:A,MarkupDrawHandler:B,ShapeMarkup:I,Dim:Y}),X=i({},g,{snapToGrid:!1,linesShift:-.5,drawHandlers:{B:new z("#222"),W:new z("#eee"),CR:new R,SQ:new j,LB:new G,TR:new W,MA:new H({lineWidth:.075}),SL:new V({color:"rgba(32, 32, 192, 0.75)"}),LN:new D,AR:new F,DD:new Y({color:"rgba(0, 0, 0, 0.5)"})}}),U=i({},X,{font:"calibri",backgroundImage:"images/wood1.jpg",stoneSize:.48,drawHandlers:i({},X.drawHandlers,{B:new L(["images/stones/black00_128.png","images/stones/black01_128.png","images/stones/black02_128.png","images/stones/black03_128.png"],new O),W:new L(["images/stones/white00_128.png","images/stones/white01_128.png","images/stones/white02_128.png","images/stones/white03_128.png","images/stones/white04_128.png","images/stones/white05_128.png","images/stones/white06_128.png","images/stones/white07_128.png","images/stones/white08_128.png","images/stones/white09_128.png","images/stones/white10_128.png"],new P)})}),q=i({},X,{font:"calibri",backgroundImage:"",drawHandlers:i({},X.drawHandlers,{B:new N,W:new k})}),J=Object.freeze({baseTheme:X,realisticTheme:U,modernTheme:q}),Z=i({},v,{theme:X}),Q=function(t,e){return t.zIndex-e.zIndex},$=function(t){function e(e,r){void 0===r&&(r={});var i=t.call(this,e,b(Z,r))||this;return i.objects=[],i.wrapperElement=document.createElement("div"),i.wrapperElement.className="wgo-board",i.wrapperElement.style.position="relative",i.element.appendChild(i.wrapperElement),i.boardElement=document.createElement("div"),i.boardElement.style.position="absolute",i.boardElement.style.left="0",i.boardElement.style.top="0",i.boardElement.style.right="0",i.boardElement.style.bottom="0",i.boardElement.style.margin="auto",i.wrapperElement.appendChild(i.boardElement),i.layers={grid:new x(i),shadow:new w(i),stone:new E(i)},i.pixelRatio=window.devicePixelRatio||1,i.resize(),i}return r(e,t),e.prototype.resize=function(){var t=this,e=this.config.theme.marginSize,r=this.config.size-this.config.viewport.left-this.config.viewport.right,i=this.config.size-this.config.viewport.top-this.config.viewport.bottom,o=e+(this.config.coordinates&&!this.config.viewport.top?.5:0),n=e+(this.config.coordinates&&!this.config.viewport.right?.5:0),s=e+(this.config.coordinates&&!this.config.viewport.bottom?.5:0),a=e+(this.config.coordinates&&!this.config.viewport.left?.5:0);this.config.width&&this.config.height?(this.width=this.config.width*this.pixelRatio,this.height=this.config.height*this.pixelRatio,this.fieldSize=Math.min(this.width/(r+a+n),this.height/(i+o+s)),this.resizeCallback&&window.removeEventListener("resize",this.resizeCallback)):this.config.width?(this.width=this.config.width*this.pixelRatio,this.fieldSize=this.width/(r+a+n),this.height=this.fieldSize*(i+o+s),this.resizeCallback&&window.removeEventListener("resize",this.resizeCallback)):this.config.height?(this.height=this.config.height*this.pixelRatio,this.fieldSize=this.height/(i+o+s),this.width=this.fieldSize*(r+a+n),this.resizeCallback&&window.removeEventListener("resize",this.resizeCallback)):(this.wrapperElement.style.width="auto",this.width=this.wrapperElement.offsetWidth*this.pixelRatio,this.fieldSize=this.width/(r+a+n),this.height=this.fieldSize*(i+o+s),this.resizeCallback||(this.resizeCallback=function(){t.resize()},window.addEventListener("resize",this.resizeCallback))),this.config.theme.snapToGrid&&(this.fieldSize=Math.floor(this.fieldSize)),this.leftOffset=this.fieldSize*(a+.5-this.config.viewport.left),this.topOffset=this.fieldSize*(o+.5-this.config.viewport.top),this.wrapperElement.style.width=this.width/this.pixelRatio+"px",this.wrapperElement.style.height=this.height/this.pixelRatio+"px";var h=(r+a+n)*this.fieldSize,l=(i+o+s)*this.fieldSize;this.boardElement.style.width=h/this.pixelRatio+"px",this.boardElement.style.height=l/this.pixelRatio+"px",Object.keys(this.layers).forEach((function(e){t.layers[e].resize(h,l)})),this.redraw()},e.prototype.getX=function(t){return this.leftOffset+t*this.fieldSize},e.prototype.getY=function(t){return this.topOffset+t*this.fieldSize},e.prototype.redraw=function(){var t=this;this.redrawScheduled||(this.redrawScheduled=!0,window.requestAnimationFrame((function(){t.redrawScheduled=!1,t.boardElement.style.backgroundColor=t.config.theme.backgroundColor,t.config.theme.backgroundImage&&(t.boardElement.style.backgroundImage='url("'+t.config.theme.backgroundImage+'")'),t.objects.sort(Q),Object.keys(t.layers).forEach((function(e){t.layers[e].clear(),t.objects.forEach((function(r){var i="string"===typeof r.type?t.config.theme.drawHandlers[r.type]:r.type;i[e]&&t.layers[e].draw(i[e].bind(i),r)}))}))})))},e.prototype.addObject=function(e){if(!Array.isArray(e)){if("string"!==typeof e.type)throw new TypeError("Invalid board object type. Custom canvas board objects not yet supported.");if(!this.config.theme.drawHandlers[e.type])throw new TypeError('Board object type "'+e.type+"\" doesn't exist in `config.theme.drawHandlers`.")}t.prototype.addObject.call(this,e),this.redraw()},e.prototype.updateObject=function(t){this.redraw()},e.prototype.removeObject=function(e){t.prototype.removeObject.call(this,e),this.redraw()},e.prototype.removeAllObjects=function(){t.prototype.removeAllObjects.call(this),this.redraw()},e.prototype.on=function(e,r){t.prototype.on.call(this,e,r),this.registerBoardListener(e)},e.prototype.registerBoardListener=function(t){var e=this;this.boardElement.addEventListener(t,(function(r){if(null!=r.layerX){var i=e.getRelativeCoordinates(r.layerX,r.layerY);e.emit(t,r,i)}else e.emit(t,r)}))},e.prototype.getRelativeCoordinates=function(t,e){var r=Math.round((t*this.pixelRatio-this.leftOffset)/this.fieldSize),i=Math.round((e*this.pixelRatio-this.topOffset)/this.fieldSize);return r<0||r>=this.config.size||i<0||i>=this.config.size?null:{x:r,y:i}},e.prototype.setSize=function(e){t.prototype.setSize.call(this,e),this.resize()},e.prototype.setViewport=function(e){t.prototype.setViewport.call(this,e),this.resize()},e.prototype.setCoordinates=function(e){t.prototype.setCoordinates.call(this,e),this.resize()},e}(C),tt="http://www.w3.org/2000/svg",et="objects",rt="gridMask",it="shadows";function ot(t,e,r,i){var o=document.createElementNS(tt,"line");return o.setAttribute("x1",t),o.setAttribute("y1",e),o.setAttribute("x2",r),o.setAttribute("y2",i),o}function nt(t,e,r){var i=document.createElementNS(tt,"circle");return i.setAttribute("cx",t),i.setAttribute("cy",e),i.setAttribute("r",r),i.setAttribute("fill","#553310"),i.setAttribute("stroke-width","0"),i}function st(t){var e=t.theme.grid.linesWidth,r=document.createElementNS(tt,"g");r.setAttribute("stroke",t.theme.grid.linesColor),r.setAttribute("stroke-width",e.toString()),r.setAttribute("fill",t.theme.grid.starColor);for(var i=0;i<t.size;i++)r.appendChild(ot(i,0-e/2,i,t.size-1+e/2)),r.appendChild(ot(0-e/2,i,t.size-1+e/2,i));var o=t.starPoints[t.size];return o&&o.forEach((function(e){r.appendChild(nt(e.x,e.y,t.theme.grid.starSize))})),r}function at(t,e,r){var i=document.createElementNS(tt,"text");return i.setAttribute("x",t),i.setAttribute("y",e),i.textContent=r,i}function ht(t){var e=document.createElementNS(tt,"g");e.style.userSelect="none",e.setAttribute("font-family",t.theme.font),e.setAttribute("font-size",t.theme.coordinates.fontSize),e.setAttribute("text-anchor","middle"),e.setAttribute("dominant-baseline","middle"),t.theme.coordinates.bold&&e.setAttribute("font-weight","bold"),e.setAttribute("fill",t.theme.coordinates.color);for(var r=0;r<t.size;r++)e.appendChild(at(r,-.75,t.coordinateLabelsX[r])),e.appendChild(at(r,t.size-.25,t.coordinateLabelsX[r])),e.appendChild(at(-.75,t.size-r-1,t.coordinateLabelsY[r])),e.appendChild(at(t.size-.25,t.size-r-1,t.coordinateLabelsY[r]));return e}var lt=function(){function t(){}return t.prototype.updateElement=function(t,e,r){var i="translate("+e.x+", "+e.y+")",o="scale("+e.scaleX+", "+e.scaleY+")",n="rotate("+e.rotate+")";Object.keys(t).forEach((function(r){t[r].setAttribute("transform",i+" "+o+" "+n),t[r].setAttribute("opacity",e.opacity)}))},t}();function pt(t){return t+"-"+Math.floor(1e9*Math.random()).toString(36)}var ct,ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createElement=function(t,e){return null},e.prototype.createShadow=function(t,e){var r=t.theme.stoneSize;if(!this.shadowFilterElement){var i=document.createElementNS(tt,"radialGradient"),o=t.theme.shadowBlur,n=Math.max(r-r*o,1e-5),s=r+1/7*r*o;i.setAttribute("id",pt("shadowFilter")),i.setAttribute("fr",String(n)),i.setAttribute("r",String(s)),i.innerHTML='\n        <stop offset="0%" stop-color="'+t.theme.shadowColor+'" />\n        <stop offset="100%" stop-color="'+t.theme.shadowTransparentColor+'" />\n      ',e(i),this.shadowFilterElement=i}var a=document.createElementNS(tt,"circle");return a.setAttribute("cx",String(t.theme.shadowOffsetX)),a.setAttribute("cy",String(t.theme.shadowOffsetY)),a.setAttribute("r",String(r)),a.setAttribute("fill","url(#"+this.shadowFilterElement.id+")"),a},e}(lt),dt=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r(e,t),e.prototype.createElement=function(e,r){if(t.prototype.createElement.call(this,e,r),!this.filterElement){var i=document.createElementNS(tt,"filter");i.setAttribute("id",pt("filter")),i.setAttribute("x","-300%"),i.setAttribute("y","-300%"),i.setAttribute("width","600%"),i.setAttribute("height","600%");var o=document.createElementNS(tt,"feGaussianBlur");o.setAttribute("in","SourceGraphic"),o.setAttribute("stdDeviation",.3*e.theme.stoneSize),i.appendChild(o),this.filterElement=i,r(i)}var n=document.createElementNS(tt,"g"),s=document.createElementNS(tt,"circle");s.setAttribute("cx","0"),s.setAttribute("cy","0"),s.setAttribute("fill","#000"),s.setAttribute("r",e.theme.stoneSize),n.appendChild(s);var a=document.createElementNS(tt,"circle");a.setAttribute("cx",-.4*e.theme.stoneSize),a.setAttribute("cy",-.4*e.theme.stoneSize),a.setAttribute("r",.25*e.theme.stoneSize),a.setAttribute("fill","#fff"),a.setAttribute("filter","url(#"+this.filterElement.id+")"),n.appendChild(a);var h=document.createElementNS(tt,"circle");return h.setAttribute("cx",.4*e.theme.stoneSize),h.setAttribute("cy",.4*e.theme.stoneSize),h.setAttribute("r",.15*e.theme.stoneSize),h.setAttribute("fill","#fff"),h.setAttribute("filter","url(#"+this.filterElement.id+")"),n.appendChild(h),n}}(ut),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r(e,t),e.prototype.createElement=function(e,r){if(t.prototype.createElement.call(this,e,r),!this.filterElement1){var i=document.createElementNS(tt,"radialGradient");i.setAttribute("id",pt("filter")),i.setAttribute("fx","30%"),i.setAttribute("fy","30%"),i.innerHTML='\n        <stop offset="10%" stop-color="rgba(255,255,255,0.9)" />\n        <stop offset="100%" stop-color="rgba(255,255,255,0)" />\n      ',r(i),this.filterElement1=i;var o=document.createElementNS(tt,"radialGradient");o.setAttribute("id",pt("filter")),o.setAttribute("fx","70%"),o.setAttribute("fy","70%"),o.innerHTML='\n        <stop offset="10%" stop-color="rgba(255,255,255,0.7)" />\n        <stop offset="100%" stop-color="rgba(255,255,255,0)" />\n      ',r(o),this.filterElement2=o}var n=document.createElementNS(tt,"g"),s=document.createElementNS(tt,"circle");s.setAttribute("cx","0"),s.setAttribute("cy","0"),s.setAttribute("fill","#ccc"),s.setAttribute("r",e.theme.stoneSize),n.appendChild(s);var a=document.createElementNS(tt,"circle");a.setAttribute("cx","0"),a.setAttribute("cy","0"),a.setAttribute("r",e.theme.stoneSize),a.setAttribute("fill","url(#"+this.filterElement1.id+")"),n.appendChild(a);var h=document.createElementNS(tt,"circle");return h.setAttribute("cx","0"),h.setAttribute("cy","0"),h.setAttribute("r",e.theme.stoneSize),h.setAttribute("fill","url(#"+this.filterElement2.id+")"),n.appendChild(h),n}}(ut),function(e){function i(t){void 0===t&&(t={});var r=e.call(this)||this;return r.params=t,r}return r(i,e),i.prototype.updateElement=function(r,i,o){e.prototype.updateElement.call(this,r,i,o),i.variation===t.Color.B?(r[et].setAttribute("stroke",o.theme.markupBlackColor),r[et].setAttribute("fill",this.params.fillColor||"rgba(0,0,0,0)")):i.variation===t.Color.W?(r[et].setAttribute("stroke",o.theme.markupWhiteColor),r[et].setAttribute("fill",this.params.fillColor||"rgba(0,0,0,0)")):(r[et].setAttribute("stroke",this.params.color||o.theme.markupNoneColor),r[et].setAttribute("fill",this.params.fillColor||"rgba(0,0,0,0)")),r[et].setAttribute("stroke-width",this.params.lineWidth||o.theme.markupLineWidth)},i}(lt)),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(tt,"circle");r.setAttribute("cx","0"),r.setAttribute("cy","0"),r.setAttribute("r","0.25");var i=document.createElementNS(tt,"circle");return i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","0.35"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[et]=r,e[rt]=i,e},e}(dt),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(tt,"rect");r.setAttribute("x","-0.25"),r.setAttribute("y","-0.25"),r.setAttribute("width","0.50"),r.setAttribute("height","0.50");var i=document.createElementNS(tt,"rect");return i.setAttribute("x","-0.35"),i.setAttribute("y","-0.35"),i.setAttribute("width","0.70"),i.setAttribute("height","0.70"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[et]=r,e[rt]=i,e},e}(dt),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(tt,"polygon");r.setAttribute("points","0,-0.25 -0.25,0.166666 0.25,0.166666");var i=document.createElementNS(tt,"polygon");return i.setAttribute("points","0,-0.35 -0.35,0.2333333 0.35,0.2333333"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[et]=r,e[rt]=i,e},e}(dt),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(tt,"path");r.setAttribute("d","M -0.20,-0.20 L 0.20,0.20 M 0.20,-0.20 L -0.20,0.20");var i=document.createElementNS(tt,"circle");return i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","0.15"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[et]=r,e[rt]=i,e},e}(dt),gt=function(t){function e(e){var r=t.call(this)||this;return r.params=e,r}return r(e,t),e.prototype.createElement=function(){var t=document.createElementNS(tt,"circle");return t.setAttribute("cx","0"),t.setAttribute("cy","0"),t.setAttribute("r","0.15"),t.setAttribute("fill",this.params.color),t},e}(lt),vt=function(t){function e(e){var r=t.call(this)||this;return r.params=e,r}return r(e,t),e.prototype.createElement=function(){var t=document.createElementNS(tt,"rect");return t.setAttribute("x","-0.5"),t.setAttribute("y","-0.5"),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill",this.params.color),t},e}(lt),Ct=function(){function t(t){void 0===t&&(t={}),this.params=t}return t.prototype.createElement=function(){var t,e=document.createElementNS(tt,"line"),r=document.createElementNS(tt,"line");return(t={})[et]=e,t[rt]=r,t},t.prototype.updateElement=function(t,e,r){t[et].setAttribute("stroke",this.params.color||r.theme.markupNoneColor),t[et].setAttribute("stroke-width",this.params.lineWidth||r.theme.markupLineWidth),t[et].setAttribute("x1",e.start.x),t[et].setAttribute("y1",e.start.y),t[et].setAttribute("x2",e.end.x),t[et].setAttribute("y2",e.end.y),t[rt].setAttribute("stroke","rgba(0,0,0,"+r.theme.markupGridMask+")"),t[rt].setAttribute("stroke-width",2*(this.params.lineWidth||r.theme.markupLineWidth)),t[rt].setAttribute("x1",e.start.x),t[rt].setAttribute("y1",e.start.y),t[rt].setAttribute("x2",e.end.x),t[rt].setAttribute("y2",e.end.y)},t}(),Et=function(){function t(t){void 0===t&&(t={}),this.params=t}return t.prototype.createElement=function(){var t;return(t={})[et]=this.createSVGElements(),t[rt]=this.createSVGElements(),t},t.prototype.createSVGElements=function(){var t=document.createElementNS(tt,"g"),e=document.createElementNS(tt,"circle"),r=document.createElementNS(tt,"line"),i=document.createElementNS(tt,"polygon");return t.appendChild(e),t.appendChild(r),t.appendChild(i),t},t.prototype.updateElement=function(t,e,r){t[et].setAttribute("stroke",this.params.color||r.theme.markupNoneColor),t[et].setAttribute("fill",this.params.color||r.theme.markupNoneColor),t[et].setAttribute("stroke-width",this.params.lineWidth||r.theme.markupLineWidth),this.updateSVGElements(t[et],e),t[rt].setAttribute("stroke","rgba(0,0,0,"+r.theme.markupGridMask+")"),t[rt].setAttribute("fill","rgba(0,0,0,"+r.theme.markupGridMask+")"),t[rt].setAttribute("stroke-width",3*(this.params.lineWidth||r.theme.markupLineWidth)),this.updateSVGElements(t[rt],e)},t.prototype.updateSVGElements=function(t,e){var r=t.children[0],i=t.children[1],o=t.children[2],n=e.start.x,s=e.start.y,a=e.end.x,h=e.end.y,l=Math.sqrt((a-n)*(a-n)+(h-s)*(h-s)),p=function(t){return n+t*(a-n)},c=function(t){return s+t*(h-s)},u=1/l/2.5,d=p(1-u),f=c(1-u),m=function(t){return d+t*(h-s)},y=function(t){return f+t*(n-a)},b=.1;r.setAttribute("cx",n),r.setAttribute("cy",s),r.setAttribute("r",b),i.setAttribute("x1",p(1/l*b)),i.setAttribute("y1",c(1/l*b)),i.setAttribute("x2",d),i.setAttribute("y2",f),o.setAttribute("points","\n      "+m(-u/1.75)+","+y(-u/1.75)+"\n      "+m(u/1.75)+","+y(u/1.75)+"\n      "+a+","+h+"\n    ")},t}(),wt=function(t){function e(e){return void 0===e&&(e={}),t.call(this,e)||this}return r(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(tt,"text");r.setAttribute("text-anchor","middle"),r.setAttribute("dominant-baseline","middle");var i=document.createElementNS(tt,"text");return i.setAttribute("text-anchor","middle"),i.setAttribute("dominant-baseline","middle"),i.setAttribute("stroke-width","0.2"),i.setAttribute("stroke","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[et]=r,e[rt]=i,e},e.prototype.updateElement=function(e,r,i){t.prototype.updateElement.call(this,e,r,i);var o=.5;1===r.text.length?o=.7:2===r.text.length&&(o=.6),e[et].setAttribute("fill",this.params.color||i.theme.markupNoneColor),e[et].setAttribute("font-family",this.params.font||i.theme.font),e[et].setAttribute("stroke-width","0"),e[et].setAttribute("font-size",o),e[et].textContent=r.text,e[rt].setAttribute("font-size",o),e[rt].textContent=r.text},e}(dt),xt=(function(t){function e(e){var r=t.call(this)||this;return r.color=e,r}r(e,t),e.prototype.createElement=function(t){var e=document.createElementNS(tt,"circle");return e.setAttribute("cx","0"),e.setAttribute("cy","0"),e.setAttribute("r",t.theme.stoneSize),e.setAttribute("fill",this.color),e}}(lt),function(t){function e(e,r){var i=t.call(this)||this;return i.fallback=r,i.randSeed=Math.ceil(9999999*Math.random()),i.paths=e,i.loadedPaths={},i}r(e,t),e.prototype.createElement=function(e,r){var i=this;t.prototype.createElement.call(this,e,r);var o,n=Math.floor(Math.random()*this.paths.length),s=document.createElementNS(tt,"g");this.loadedPaths[n]||((o=this.fallback.createElement(e,r))instanceof SVGElement||(o=o[et]),s.appendChild(o));var a=document.createElementNS(tt,"image");return a.setAttribute("href",this.paths[n]),a.setAttribute("width",2*e.theme.stoneSize),a.setAttribute("height",2*e.theme.stoneSize),a.setAttribute("x",-e.theme.stoneSize),a.setAttribute("y",-e.theme.stoneSize),this.loadedPaths[n]||a.setAttribute("opacity","0"),a.addEventListener("load",(function(){o&&(a.setAttribute("opacity","1"),s.removeChild(o),i.loadedPaths[n]=!0)})),s.appendChild(a),s}}(ut),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createElement=function(e,r){var i;if(t.prototype.createElement.call(this,e,r),!this.filterElement1){var o=document.createElementNS(tt,"radialGradient");o.setAttribute("id",pt("filter")),o.setAttribute("cx","45%"),o.setAttribute("cy","45%"),o.setAttribute("fx","20%"),o.setAttribute("fy","20%"),o.setAttribute("r","60%"),o.innerHTML='\n        <stop offset="0%" stop-color="rgba(255,255,255,1)" />\n        <stop offset="80%" stop-color="rgba(215,215,215,1)" />\n        <stop offset="100%" stop-color="rgba(170,170,170,1)" />\n      ',r(o),this.filterElement1=o}var n=document.createElementNS(tt,"g"),s=document.createElementNS(tt,"circle");return s.setAttribute("cx","0"),s.setAttribute("cy","0"),s.setAttribute("fill","url(#"+this.filterElement1.id+")"),s.setAttribute("r",e.theme.stoneSize),n.appendChild(s),(i={})[et]=n,i[it]=this.createShadow(e,r),i},e}(ut)),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createElement=function(e,r){var i;if(t.prototype.createElement.call(this,e,r),!this.filterElement1){var o=document.createElementNS(tt,"radialGradient");o.setAttribute("id",pt("filter")),o.setAttribute("cx","45%"),o.setAttribute("cy","45%"),o.setAttribute("fx","20%"),o.setAttribute("fy","20%"),o.setAttribute("r","60%"),o.innerHTML='\n        <stop offset="0%" stop-color="rgba(48,48,48,1)" />\n        <stop offset="80%" stop-color="rgba(16,16,16,1)" />\n        <stop offset="100%" stop-color="rgba(0,0,0,1)" />\n      ',r(o),this.filterElement1=o}var n=document.createElementNS(tt,"g"),s=document.createElementNS(tt,"circle");return s.setAttribute("cx","0"),s.setAttribute("cy","0"),s.setAttribute("fill","url(#"+this.filterElement1.id+")"),s.setAttribute("r",e.theme.stoneSize),n.appendChild(s),(i={})[et]=n,i[it]=this.createShadow(e,r),i},e}(ut),At=i({},g,{markupGridMask:.8,stoneSize:.48,coordinates:i({},g.coordinates,{fontSize:.5}),grid:i({},g.grid,{linesWidth:.03,starSize:.09}),drawHandlers:{CR:new ft,SQ:new mt,LB:new wt,TR:new yt,MA:new bt({lineWidth:.075}),SL:new gt({color:"rgba(32, 32, 192, 0.75)"}),LN:new Ct,AR:new Et,DD:new vt({color:"rgba(0, 0, 0, 0.5)"}),W:new xt,B:new St}}),Nt=i({},v,{theme:At}),Mt=function(t){function e(e,r){void 0===r&&(r={});var i=t.call(this,e,b(Nt,r))||this;return i.objects=[],i.contexts={},i.boardElement=document.createElement("div"),i.boardElement.style.display="inline-block",i.boardElement.style.position="relative",i.boardElement.style.verticalAlign="middle",i.boardElement.style.userSelect="none",i.element.appendChild(i.boardElement),i.touchArea=document.createElement("div"),i.touchArea.style.position="absolute",i.touchArea.style.top="0",i.touchArea.style.left="0",i.touchArea.style.bottom="0",i.touchArea.style.right="0",i.touchArea.style.zIndex="1",i.touchArea.style.borderTop="#F0E7A7 solid 1px",i.touchArea.style.borderRight="#D1A974 solid 1px",i.touchArea.style.borderLeft="#CCB467 solid 1px",i.touchArea.style.borderBottom="#665926 solid 1px",i.boardElement.appendChild(i.touchArea),i.svgElement=document.createElementNS(tt,"svg"),i.svgElement.style.display="block",i.boardElement.appendChild(i.svgElement),i.defsElement=document.createElementNS(tt,"defs"),i.svgElement.appendChild(i.defsElement),i.setViewport(),i.resize(),i.redraw(),i}return r(e,t),e.prototype.resize=function(){this.config.width&&this.config.height?(this.boardElement.style.width="",this.svgElement.style.width=this.config.width+"px",this.svgElement.style.height=this.config.height+"px"):this.config.width?(this.boardElement.style.width="",this.svgElement.style.width=this.config.width+"px",this.svgElement.style.height="auto"):this.config.height?(this.boardElement.style.width="",this.svgElement.style.width="auto",this.svgElement.style.height=this.config.height+"px"):(this.boardElement.style.width="100%",this.svgElement.style.width="100%",this.svgElement.style.height="auto")},e.prototype.redraw=function(){this.svgElement.style.backgroundColor=this.config.theme.backgroundColor,this.config.theme.backgroundImage?this.svgElement.style.backgroundImage="url('"+this.config.theme.backgroundImage+"')":this.svgElement.style.backgroundImage="",this.drawGrid(),this.drawCoordinates(),this.drawObjects()},e.prototype.drawGrid=function(){this.contexts[rt]&&this.svgElement.removeChild(this.contexts[rt]),this.contexts.gridElement&&this.svgElement.removeChild(this.contexts.gridElement);var t=this.config.size;this.contexts[rt]=document.createElementNS(tt,"mask"),this.contexts[rt].id=pt("mask"),this.contexts[rt].innerHTML='<rect x="-0.5" y="-0.5" width="'+t+'" height="'+t+'" fill="white" />',this.svgElement.appendChild(this.contexts[rt]),this.contexts.gridElement=st(this.config),this.contexts.gridElement.setAttribute("mask","url(#"+this.contexts[rt].id+")"),this.svgElement.appendChild(this.contexts.gridElement)},e.prototype.drawCoordinates=function(){this.contexts.coordinatesElement&&this.svgElement.removeChild(this.contexts.coordinatesElement),this.contexts.coordinatesElement=ht(this.config),this.contexts.coordinatesElement.style.opacity=this.config.coordinates?"":"0",this.svgElement.appendChild(this.contexts.coordinatesElement)},e.prototype.drawObjects=function(){var t=this;this.contexts[it]&&this.svgElement.removeChild(this.contexts[it]),this.contexts[et]&&this.svgElement.removeChild(this.contexts[et]),this.contexts[it]=document.createElementNS(tt,"g"),this.svgElement.appendChild(this.contexts[it]),this.contexts[et]=document.createElementNS(tt,"g"),this.svgElement.appendChild(this.contexts[et]),this.objectsElementMap=new Map,this.objects.forEach((function(e){return t.createObjectElements(e)}))},e.prototype.addObject=function(e){if(t.prototype.addObject.call(this,e),!Array.isArray(e)){if(this.objectsElementMap.get(e))return void this.updateObject(e);this.createObjectElements(e)}},e.prototype.createObjectElements=function(t){var e,r,i=this,o=this.getObjectHandler(t),n=o.createElement(this.config,(function(t){return i.defsElement.appendChild(t)}));n instanceof SVGElement?((e={})[et]=n,r=e):r=n,this.objectsElementMap.set(t,r),Object.keys(r).forEach((function(t){return i.contexts[t].appendChild(r[t])})),o.updateElement(r,t,this.config)},e.prototype.getObjectHandler=function(t){return"handler"in t?t.handler:this.config.theme.drawHandlers[t.type]},e.prototype.removeObject=function(e){var r=this;if(t.prototype.removeObject.call(this,e),!Array.isArray(e)){var i=this.objectsElementMap.get(e);i&&(this.objectsElementMap.delete(e),Object.keys(i).forEach((function(t){return r.contexts[t].removeChild(i[t])})))}},e.prototype.updateObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.updateObject(t[e]);else{var r=this.objectsElementMap.get(t);r&&this.getObjectHandler(t).updateElement(r,t,this.config)}},e.prototype.setViewport=function(e){void 0===e&&(e=this.config.viewport),t.prototype.setViewport.call(this,e);var r=this.config,i=r.coordinates,o=r.theme,n=r.size,s=o.marginSize,a=o.coordinates.fontSize;this.top=e.top-.5-(i&&!e.top?a:0)-s,this.left=e.left-.5-(i&&!e.left?a:0)-s,this.bottom=n-.5-this.top-e.bottom+(i&&!e.bottom?a:0)+s,this.right=n-.5-this.left-e.right+(i&&!e.right?a:0)+s,this.svgElement.setAttribute("viewBox",this.left+" "+this.top+" "+this.right+" "+this.bottom)},e.prototype.setSize=function(e){void 0===e&&(e=19),t.prototype.setSize.call(this,e),this.drawGrid(),this.drawCoordinates(),this.setViewport()},e.prototype.setCoordinates=function(e){t.prototype.setCoordinates.call(this,e),this.contexts.coordinatesElement.style.opacity=this.config.coordinates?"":"0",this.setViewport()},e.prototype.on=function(e,r){t.prototype.on.call(this,e,r),this.registerBoardListener(e)},e.prototype.registerBoardListener=function(t){var e=this;this.touchArea.addEventListener(t,(function(r){if(null!=r.layerX){var i=e.getRelativeCoordinates(r.layerX,r.layerY);e.emit(t,r,i)}else e.emit(t,r)}))},e.prototype.getRelativeCoordinates=function(t,e){var r=this.touchArea.offsetWidth/this.right,i=this.touchArea.offsetHeight/this.bottom,o=Math.round(t/r+this.left),n=Math.round(e/i+this.top);return o<0||o>=this.config.size||n<0||n>=this.config.size?null:{x:o,y:n}},e}(C);(ct=t.Repeating||(t.Repeating={})).KO="KO",ct.ALL="ALL",ct.NONE="NONE";var kt={repeating:t.Repeating.KO,allowRewrite:!1,allowSuicide:!1,komi:6.5},Ot={repeating:t.Repeating.NONE,allowRewrite:!1,allowSuicide:!1,komi:7.5},Pt={repeating:t.Repeating.NONE,allowRewrite:!1,allowSuicide:!0,komi:7.5},_t={repeating:t.Repeating.ALL,allowRewrite:!0,allowSuicide:!0,komi:0},Tt={Japanese:kt,GOE:Pt,NZ:Pt,AGA:Ot,Chinese:Ot};function zt(t){for(var e=[],r=0;r<t;r++)e.push([]);return e}var Lt=function(){function e(e){void 0===e&&(e=19),this.grid=[],this.capCount={black:0,white:0},this.turn=t.Color.BLACK,this.size=e,this.clear()}return e.prototype.isOnPosition=function(t,e){return t>=0&&e>=0&&t<this.size&&e<this.size},e.prototype.get=function(t,e){if(this.isOnPosition(t,e))return this.grid[t*this.size+e]},e.prototype.set=function(t,e,r){if(!this.isOnPosition(t,e))throw new TypeError("Attempt to set field outside of position.");return this.grid[t*this.size+e]=r,this},e.prototype.clear=function(){for(var e=0;e<this.size*this.size;e++)this.grid[e]=t.Color.EMPTY;return this},e.prototype.clone=function(){var t=new e(this.size);return t.grid=this.grid.slice(0),t.capCount.black=this.capCount.black,t.capCount.white=this.capCount.white,t.turn=this.turn,t},e.prototype.compare=function(t){if(t.size!==this.size)throw new TypeError("Positions of different sizes cannot be compared.");for(var e=[],r=0;r<this.size*this.size;r++)this.grid[r]!==t.grid[r]&&e.push({x:Math.floor(r/this.size),y:r%this.size,c:t.grid[r]});return e},e.prototype.applyMove=function(e,r,i,o,n){if(void 0===i&&(i=this.turn),void 0===o&&(o=!1),void 0===n&&(n=!1),!n&&this.get(e,r)!==t.Color.EMPTY)return!1;var s=this.get(e,r);this.set(e,r,i);var a=this.get(e,r-1)===-i&&this.captureIfNoLiberties(e,r-1),h=this.get(e+1,r)===-i&&this.captureIfNoLiberties(e+1,r),l=this.get(e,r+1)===-i&&this.captureIfNoLiberties(e,r+1),p=this.get(e-1,r)===-i&&this.captureIfNoLiberties(e-1,r);if(!(a||h||l||p)&&!this.hasLiberties(e,r)){if(!o)return this.set(e,r,s),!1;this.capture(e,r,i)}return this.turn=-i,!0},e.prototype.validatePosition=function(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++)this.captureIfNoLiberties(t-1,e);return this},e.prototype.hasLiberties=function(e,r,i,o){return void 0===i&&(i=zt(this.size)),void 0===o&&(o=this.get(e,r)),!!this.isOnPosition(e,r)&&(this.get(e,r)===t.Color.EMPTY||!i[e][r]&&this.get(e,r)!==-o&&(i[e][r]=!0,this.hasLiberties(e,r-1,i,o)||this.hasLiberties(e,r+1,i,o)||this.hasLiberties(e-1,r,i,o)||this.hasLiberties(e+1,r,i,o)))},e.prototype.captureIfNoLiberties=function(t,e){return!this.hasLiberties(t,e)&&(this.capture(t,e),!0)},e.prototype.capture=function(e,r,i){void 0===i&&(i=this.get(e,r)),this.isOnPosition(e,r)&&i!==t.Color.EMPTY&&this.get(e,r)===i&&(this.set(e,r,t.Color.EMPTY),i===t.Color.BLACK?this.capCount.white=this.capCount.white+1:this.capCount.black=this.capCount.black+1,this.capture(e,r-1,i),this.capture(e,r+1,i),this.capture(e-1,r,i),this.capture(e+1,r,i))},e.prototype.toString=function(){for(var e="\u250c",r="\u252c",i="\u2510",o="\u251c",n="\u253c",s="\u2524",a="\u2514",h="\u2534",l="\u2518",p="\u25cf",c="\u25cb",u="\u2500",d="   ",f=0;f<this.size;f++)d+=f<9?f+" ":f;d+="\n";for(var m=0;m<this.size;m++)for(var y=0;y<this.size;y++){var b=this.grid[y*this.size+m];0===y&&(d+=(m<10?" "+m:m)+" "),b!==t.Color.EMPTY?d+=b===t.Color.BLACK?p:c:d+=0===m?0===y?e:y<this.size-1?r:i:m<this.size-1?0===y?o:y<this.size-1?n:s:0===y?a:y<this.size-1?h:l,y===this.size-1?m!==this.size-1&&(d+="\n"):d+=u}return d},e.prototype.toTwoDimensionalArray=function(){for(var t=[],e=0;e<this.size;e++){t[e]=[];for(var r=0;r<this.size;r++)t[e][r]=this.grid[e*this.size+r]}return t},e}(),Bt=function(){function e(t,e){void 0===t&&(t=19),void 0===e&&(e=kt),this.size=t,this.rules=e,this.komi=e.komi,this.positionStack=[new Lt(t)]}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionStack[this.positionStack.length-1]},set:function(t){this.positionStack[this.positionStack.length-1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"turn",{get:function(){return this.position.turn},set:function(t){this.position.turn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"capCount",{get:function(){return this.position.capCount},enumerable:!0,configurable:!0}),e.prototype.play=function(t,e){var r=this.tryToPlay(t,e);return r&&this.pushPosition(r),r},e.prototype.tryToPlay=function(t,e){var r=this.position.clone();return!(!r.applyMove(t,e,r.turn,this.rules.allowSuicide,this.rules.allowRewrite)||this.hasPositionRepeated(r))&&r},e.prototype.hasPositionRepeated=function(e){var r;if(this.rules.repeating===t.Repeating.KO&&this.positionStack.length-2>=0)r=this.positionStack.length-2;else{if(this.rules.repeating!==t.Repeating.NONE)return!1;r=0}for(var i=this.positionStack.length-1;i>=r;i--)if(0===this.positionStack[i].compare(e).length)return!0;return!1},e.prototype.pass=function(t){void 0===t&&(t=this.turn);var e=this.position.clone();e.turn=-(t||this.turn),this.pushPosition(e)},e.prototype.isValid=function(t,e){return!!this.tryToPlay(t,e)},e.prototype.isOnBoard=function(t,e){return this.position.isOnPosition(t,e)},e.prototype.addStone=function(e,r,i){return!(!this.isOnBoard(e,r)||this.position.get(e,r)!==t.Color.EMPTY)&&(this.position.set(e,r,i),!0)},e.prototype.removeStone=function(e,r){return!(!this.isOnBoard(e,r)||this.position.get(e,r)===t.Color.EMPTY)&&(this.position.set(e,r,t.Color.EMPTY),!0)},e.prototype.setStone=function(t,e,r){return!!this.isOnBoard(t,e)&&(this.position.set(t,e,r),!0)},e.prototype.getStone=function(t,e){return this.position.get(t,e)},e.prototype.pushPosition=function(t){return this.positionStack.push(t)},e.prototype.popPosition=function(){return this.positionStack.length>1?this.positionStack.pop():null},e.prototype.clear=function(){this.positionStack=[this.positionStack[0]]},e}(),It={read:function(t){return!0},write:function(t){return""}},Rt={read:function(t){return parseFloat(t)},write:function(t){return t.toString(10)}},jt={read:function(t){return t},write:function(t){return t}},Wt={read:function(e){return"w"===e||"W"===e?t.Color.WHITE:t.Color.BLACK},write:function(e){return e===t.Color.WHITE?"W":"B"}},Gt={read:function(t){return t?{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97}:null},write:function(t){return t?String.fromCharCode(t.x+97)+String.fromCharCode(t.y+97):""}},Vt={read:function(t){return{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97,text:t.substr(3)}},write:function(t){return String.fromCharCode(t.x+97)+String.fromCharCode(t.y+97)+":"+t.text}},Ht={read:function(t){return t?[{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97},{x:t.charCodeAt(3)-97,y:t.charCodeAt(4)-97}]:null},write:function(t){return t?String.fromCharCode(t[0].x+97)+String.fromCharCode(t[0].y+97)+":"+(String.fromCharCode(t[1].x+97)+String.fromCharCode(t[1].y+97)):""}},Dt={_default:{transformer:jt,multiple:!1,notEmpty:!0}};Dt.B=Dt.W={transformer:Gt,multiple:!1,notEmpty:!1},Dt.KO={transformer:It,multiple:!1,notEmpty:!1},Dt.MN={transformer:Rt,multiple:!1,notEmpty:!0},Dt.AB=Dt.AW=Dt.AE={transformer:Gt,multiple:!0,notEmpty:!0},Dt.PL={transformer:Wt,multiple:!1,notEmpty:!0},Dt.C=Dt.N={transformer:jt,multiple:!1,notEmpty:!0},Dt.DM=Dt.GB=Dt.GW=Dt.HO=Dt.UC=Dt.V={transformer:Rt,multiple:!1,notEmpty:!0},Dt.BM=Dt.TE={transformer:Rt,multiple:!1,notEmpty:!0},Dt.DO=Dt.IT={transformer:It,multiple:!1,notEmpty:!1},Dt.CR=Dt.MA=Dt.SL=Dt.SQ=Dt.TR={transformer:Gt,multiple:!0,notEmpty:!0},Dt.LB={transformer:Vt,multiple:!0,notEmpty:!0},Dt.AR=Dt.LN={transformer:Ht,multiple:!0,notEmpty:!0},Dt.DD=Dt.TB=Dt.TW={transformer:Gt,multiple:!0,notEmpty:!1},Dt.AP=Dt.CA={transformer:jt,multiple:!1,notEmpty:!0},Dt.FF=Dt.GM=Dt.ST=Dt.SZ={transformer:Rt,multiple:!1,notEmpty:!0},Dt.AN=Dt.BR=Dt.BT=Dt.CP=Dt.DT=Dt.EV=Dt.GN=Dt.GC=Dt.GN=Dt.ON=Dt.OT=Dt.PB=Dt.PC=Dt.PW=Dt.RE=Dt.RO=Dt.RU=Dt.SO=Dt.US=Dt.WR=Dt.WT={transformer:jt,multiple:!1,notEmpty:!0},Dt.TM=Dt.HA=Dt.KM={transformer:Rt,multiple:!1,notEmpty:!0},Dt.BL=Dt.WL=Dt.OB=Dt.OW={transformer:Rt,multiple:!1,notEmpty:!0},Dt.PM={transformer:Rt,multiple:!1,notEmpty:!0},Dt.VW={transformer:Ht,multiple:!1,notEmpty:!0};var Ft,Yt=function t(e,r){r.setSGFProperties(e.sequence[0]||{});for(var i=r,o=1;o<e.sequence.length;o++){var n=new Ut;n.setSGFProperties(e.sequence[o]),i.appendChild(n),i=n}for(o=0;o<e.children.length;o++)i.appendChild(t(e.children[o],new Ut));return r},Kt=["\\\\","\\]"],Xt=function(t){return Kt.reduce((function(t,e){return t.replace(new RegExp(e,"g"),e)}),t)},Ut=function(){function t(){this.parent=null,this.children=[],this.properties={}}return Object.defineProperty(t.prototype,"root",{get:function(){for(var t=this;null!=t.parent;)t=t.parent;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerSGF",{get:function(){var t=";";for(var e in this.properties)this.properties.hasOwnProperty(e)&&(t+=e+"["+this.getSGFProperty(e).map(Xt).join("][")+"]");return 1===this.children.length?""+t+this.children[0].innerSGF:this.children.length>1?this.children.reduce((function(t,e){return t+"("+e.innerSGF+")"}),t):t},set:function(e){this.clean();var r=e;"("!==r[0]&&(";"!==r[0]&&(r=";"+r),r="("+r+")"),t.fromSGF(r,0,this)},enumerable:!0,configurable:!0}),t.prototype.getPath=function(){for(var t={depth:0,forks:[]},e=this;e.parent;)t.depth++,e.parent.children.length>1&&t.forks.unshift(e.parent.children.indexOf(e)),e=e.parent;return t},t.prototype.appendChild=function(e){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `appendChild` method, KNode was expected.");return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e)-1},t.prototype.contains=function(t){return this.children.indexOf(t)>=0||this.children.some((function(e){return e.contains(t)}))},t.prototype.insertBefore=function(e,r){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `insertBefore` method, KNode was expected.");return null==r?(this.appendChild(e),this):(e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(this.children.indexOf(r),0,e),this)},t.prototype.removeChild=function(t){return this.children.splice(this.children.indexOf(t),1),t.parent=null,this},t.prototype.replaceChild=function(e,r){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `replaceChild` method, KNode was expected.");return this.insertBefore(e,r),this.removeChild(r),this},t.prototype.clean=function(){for(var t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);this.properties={}},t.prototype.getProperty=function(t){return this.properties[t]},t.prototype.setProperty=function(t,e){return void 0===e?delete this.properties[t]:this.properties[t]=e,this},t.prototype.removeProperty=function(t){this.setProperty(t)},t.prototype.forEachProperty=function(t){var e=this;Object.keys(this.properties).forEach((function(r){return t(r,e.properties[r])}))},t.prototype.getSGFProperty=function(t){if(void 0!==this.properties[t]){var e=Dt[t]||Dt._default;return e.multiple?this.properties[t].map((function(t){return e.transformer.write(t)})):[e.transformer.write(this.properties[t])]}return null},t.prototype.setSGFProperty=function(t,e){var r=Dt[t]||Dt._default;return void 0===e?(delete this.properties[t],this):(r.multiple?this.properties[t]=e.map((function(t){return r.transformer.read(t)})):this.properties[t]=r.transformer.read(e[0]),this)},t.prototype.setSGFProperties=function(t){for(var e in t)t.hasOwnProperty(e)&&this.setSGFProperty(e,t[e]);return this},t.prototype.toSGF=function(){return"("+this.innerSGF+")"},t.prototype.cloneNode=function(e){var r=new t,i=JSON.parse(JSON.stringify(this.properties));return r.properties=i,this.children.forEach((function(t){r.appendChild(t.cloneNode())})),e&&this.parent&&this.parent.appendChild(r),r},t.fromJS=function(e,r){return void 0===r&&(r=new t),Yt(e,r)},t.fromSGF=function(e,r,i){void 0===r&&(r=0),void 0===i&&(i=new t);var o=new p(e);return t.fromJS(o.parseCollection()[r],i)},t}();function qt(t){t.target.params.size=t.value}function Jt(t){Tt[t.value]&&(t.target.params.rules=Tt[t.value])}function Zt(e){e.value>1&&e.target.currentNode===e.target.rootNode&&!e.target.getProperty(Ft.SET_TURN)&&(e.target.game.position.turn=t.Color.WHITE)}function Qt(e){var r="B"===e.propIdent?t.Color.B:t.Color.W;e.value&&e.target.game.position.applyMove(e.value.x,e.value.y,r,!0,!0),e.target.game.position.turn=-r}function $t(t){t.target.game.turn=t.value}function te(e){var r;switch(e.propIdent){case"AB":r=t.Color.B;break;case"AW":r=t.Color.W;break;case"AE":r=t.Color.E}e.value.forEach((function(t){e.target.game.setStone(t.x,t.y,r)}))}!function(t){t.BLACK_MOVE="B",t.EXECUTE_ILLEGAL="KO",t.MOVE_NUMBER="MN",t.WHITE_MOVE="W",t.ADD_BLACK="AB",t.CLEAR_FIELD="AE",t.ADD_WHITE="AW",t.SET_TURN="PL",t.COMMENT="C",t.EVEN_POSITION="DM",t.GOOD_FOR_BLACK="GB",t.GOOD_FOR_WHITE="GW",t.HOTSPOT="HO",t.NODE_NAME="N",t.UNCLEAR_POSITION="UC",t.NODE_VALUE="V",t.BAD_MOVE="BM",t.DOUBTFUL_MOVE="DM",t.INTERESTING_MOVE="IT",t.GOOD_MOVE="TE",t.ARROW="AR",t.CIRCLE="CR",t.DIM="DD",t.LABEL="LB",t.LINE="LN",t.X_MARK="MA",t.SELECTED="SL",t.SQUARE="SQ",t.TRIANGLE="TR",t.APPLICATION="AP",t.CHARSET="CA",t.SGF_VERSION="FF",t.GAME_TYPE="GM",t.VARIATIONS_STYLE="ST",t.BOARD_SIZE="SZ",t.ANNOTATOR="AN",t.BLACK_RANK="BR",t.BLACK_TEAM="BT",t.COPYRIGHT="CP",t.DATE="DT",t.EVENT="EV",t.GAME_NAME="GN",t.GAME_COMMENT="GC",t.OPENING_INFO="ON",t.OVER_TIME="OT",t.BLACK_NAME="BN",t.PLACE="PC",t.WHITE_NAME="PW",t.RESULT="RE",t.ROUND="RO",t.RULES="RU",t.SOURCE="SO",t.TIME_LIMITS="TM",t.AUTHOR="US",t.WHITE_RANK="WR",t.WHITE_TEAM="WT",t.BLACK_TIME_LEFT="BL",t.BLACK_STONES_LEFT="OB",t.WHITE_STONES_LEFT="OW",t.WHITE_TIME_LEFT="WL",t.FIGURE="FG",t.PRINT_MOVE_NUMBERS="PM",t.BOARD_SECTION="VW",t.HANDICAP="HA",t.KOMI="KM",t.BLACK_TERRITORY="TB",t.WHITE_TERRITORY="TW"}(Ft||(Ft={}));var ee=function(e){function i(){var t=e.call(this)||this;return t.playerStateStack=[],t.on("beforeInit.SZ",qt),t.on("beforeInit.RU",Jt),t.on("applyGameChanges.HA",Zt),t.on("applyGameChanges.B",Qt),t.on("applyGameChanges.W",Qt),t.on("applyGameChanges.PL",$t),t.on("applyGameChanges.AB",te),t.on("applyGameChanges.AW",te),t.on("applyGameChanges.AE",te),t}return r(i,e),i.prototype.loadKifu=function(t){this.rootNode=t,this.currentNode=t,this.emit("loadKifu",{name:"loadKifu",kifuNode:t,target:this}),this.executeRoot()},i.prototype.newGame=function(t,e){var r=new Ut;if(t&&r.setProperty("SZ",t),e){var i=Object.keys(Tt).find((function(t){return Tt[t]===e}));i&&r.setProperty("RU",i)}this.loadKifu(r)},i.prototype.executeRoot=function(){this.params={size:19,rules:kt},this.emitNodeLifeCycleEvent("beforeInit"),this.game=new Bt(this.params.size,this.params.rules),this.executeNode()},i.prototype.executeNode=function(){this.emitNodeLifeCycleEvent("applyGameChanges"),this.emitNodeLifeCycleEvent("applyNodeChanges")},i.prototype.executeNext=function(t){this.emitNodeLifeCycleEvent("clearNodeChanges"),this.game.pushPosition(this.game.position.clone()),this.currentNode=this.currentNode.children[t],this.executeNode()},i.prototype.executePrevious=function(){this.emitNodeLifeCycleEvent("clearNodeChanges"),this.emitNodeLifeCycleEvent("clearGameChanges"),this.game.popPosition(),this.currentNode=this.currentNode.parent,this.emitNodeLifeCycleEvent("applyNodeChanges")},i.prototype.emitNodeLifeCycleEvent=function(t){var e=this;this.emit(t,{name:t,target:this}),this.currentNode.forEachProperty((function(r,i){e.emit(t+"."+r,{name:t,target:e,propIdent:r,value:i})}))},i.prototype.getPropertyHandler=function(t){return this.constructor.propertyHandlers[t]},i.prototype.getProperty=function(t){return this.currentNode.getProperty(t)},i.prototype.setProperty=function(t,e){this.emitNodeLifeCycleEvent("clearNodeChanges"),this.emitNodeLifeCycleEvent("clearGameChanges"),this.currentNode.setProperty(t,e),this.executeNode()},i.prototype.getRootProperty=function(t){return this.rootNode.getProperty(t)},i.prototype.getNextNodes=function(){return this.currentNode.children},i.prototype.next=function(t){if(void 0===t&&(t=0),this.currentNode.children.length){var e=void 0;if(e="number"===typeof t?t:this.currentNode.children.indexOf(t),this.currentNode.children[e])return this.executeNext(e),!0}return!1},i.prototype.previous=function(){return!!this.currentNode.parent&&(this.executePrevious(),!0)},i.prototype.first=function(){for(;this.previous(););},i.prototype.last=function(){for(;this.next(););},i.prototype.goTo=function(t){var e="number"===typeof t?{depth:t,forks:[]}:t;this.first();for(var r=0,i=0;r<e.depth;r++)this.currentNode.children.length>1?this.next(e.forks[i++]):this.next()},i.prototype.getCurrentPath=function(){var t={depth:0,forks:[]};if(this.currentNode)for(var e=this.currentNode;e.parent;)t.depth++,e.parent.children.length>1&&t.forks.push(e.parent.children.indexOf(e)),e=e.parent;return t},i.prototype.previousFork=function(){for(;this.previous();)if(this.currentNode.children.length>1)return},i.prototype.play=function(e,r){var i=new Ut;this.game.turn===t.Color.W?i.setProperty(Ft.WHITE_MOVE,{x:e,y:r}):i.setProperty(Ft.BLACK_MOVE,{x:e,y:r});var o=this.currentNode.appendChild(i);this.next(o)},i.prototype.save=function(){this.playerStateStack.push({rootNode:this.rootNode.cloneNode(),path:this.getCurrentPath()})},i.prototype.restore=function(){var t=this.playerStateStack.pop();t&&(this.first(),this.loadKifu(t.rootNode),this.goTo(t.path))},i}(y),re={boardTheme:g,highlightCurrentMove:!0,currentMoveBlackMark:new ft({color:"rgba(255,255,255,0.8)",fillColor:"rgba(0,0,0,0)"}),currentMoveWhiteMark:new ft({color:"rgba(0,0,0,0.8)",fillColor:"rgba(0,0,0,0)"}),enableMouseWheel:!0,enableKeys:!0,showVariations:!0,showCurrentVariations:!1,variationDrawHandler:new wt({color:"#33f"}),formatNicks:!0,formatMoves:!0},ie=function(){function t(){}return t.prototype.didMount=function(t){},t}(),oe=function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this,"custom",r,i)||this;return o.handler=e,o}return r(e,t),e}(u),ne=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(f),se={B:t.Color.BLACK,W:t.Color.WHITE},ae=function(e){function i(t){void 0===t&&(t={});var r=e.call(this)||this;return r.boardConfig=t,r.viewportStack=[],r.applyNodeChanges=r.applyNodeChanges.bind(r),r.clearNodeChanges=r.clearNodeChanges.bind(r),r.applyMarkupProperty=r.applyMarkupProperty.bind(r),r.applyLabelMarkupProperty=r.applyLabelMarkupProperty.bind(r),r.applyLineMarkupProperty=r.applyLineMarkupProperty.bind(r),r.applyViewportProperty=r.applyViewportProperty.bind(r),r.clearViewportProperty=r.clearViewportProperty.bind(r),r.applyMoveProperty=r.applyMoveProperty.bind(r),r.addTemporaryBoardObject=r.addTemporaryBoardObject.bind(r),r.removeTemporaryBoardObject=r.removeTemporaryBoardObject.bind(r),r.updateTemporaryBoardObject=r.updateTemporaryBoardObject.bind(r),r.setCoordinates=r.setCoordinates.bind(r),r}return r(i,e),i.prototype.create=function(t){var e=this;return this.player=t,this.player.coordinates=this.boardConfig.coordinates,this.boardElement=document.createElement("div"),this.boardElement.className="wgo-player__board",this.stoneBoardsObjects=[],this.temporaryBoardObjects=[],this.board=new Mt(this.boardElement,this.boardConfig),this.board.on("click",(function(t,r){e.handleBoardClick(r)})),this.board.on("mousemove",(function(t,r){r?r.x===e.boardMouseX&&r.y===e.boardMouseY||(e.boardMouseX=r.x,e.boardMouseY=r.y,e.handleBoardMouseMove(r)):null!=e.boardMouseX&&(e.boardMouseX=null,e.boardMouseY=null,e.handleBoardMouseOut())})),this.board.on("mouseout",(function(t,r){if(!r&&null!=e.boardMouseX)return e.boardMouseX=null,e.boardMouseY=null,void e.handleBoardMouseOut()})),this.player.on("applyNodeChanges",this.applyNodeChanges),this.player.on("clearNodeChanges",this.clearNodeChanges),this.player.on("applyNodeChanges.CR",this.applyMarkupProperty),this.player.on("applyNodeChanges.TR",this.applyMarkupProperty),this.player.on("applyNodeChanges.SQ",this.applyMarkupProperty),this.player.on("applyNodeChanges.SL",this.applyMarkupProperty),this.player.on("applyNodeChanges.MA",this.applyMarkupProperty),this.player.on("applyNodeChanges.DD",this.applyMarkupProperty),this.player.on("applyNodeChanges.LB",this.applyLabelMarkupProperty),this.player.on("applyNodeChanges.LN",this.applyLineMarkupProperty),this.player.on("applyNodeChanges.AR",this.applyLineMarkupProperty),this.player.on("applyGameChanges.VW",this.applyViewportProperty),this.player.on("clearGameChanges.VW",this.clearViewportProperty),this.player.on("applyNodeChanges.B",this.applyMoveProperty),this.player.on("applyNodeChanges.W",this.applyMoveProperty),this.player.on("board.addTemporaryObject",this.addTemporaryBoardObject),this.player.on("board.removeTemporaryObject",this.removeTemporaryBoardObject),this.player.on("board.updateTemporaryObject",this.updateTemporaryBoardObject),this.player.on("board.setCoordinates",this.setCoordinates),this.boardElement},i.prototype.destroy=function(){this.player.off("applyNodeChanges",this.applyNodeChanges),this.player.off("clearNodeChanges",this.clearNodeChanges),this.player.off("applyNodeChanges",this.applyNodeChanges),this.player.off("clearNodeChanges",this.clearNodeChanges),this.player.off("applyNodeChanges.CR",this.applyMarkupProperty),this.player.off("applyNodeChanges.TR",this.applyMarkupProperty),this.player.off("applyNodeChanges.SQ",this.applyMarkupProperty),this.player.off("applyNodeChanges.SL",this.applyMarkupProperty),this.player.off("applyNodeChanges.MA",this.applyMarkupProperty),this.player.off("applyNodeChanges.DD",this.applyMarkupProperty),this.player.off("applyNodeChanges.LB",this.applyLabelMarkupProperty),this.player.off("applyNodeChanges.LN",this.applyLineMarkupProperty),this.player.off("applyNodeChanges.AR",this.applyLineMarkupProperty),this.player.off("applyGameChanges.VW",this.applyViewportProperty),this.player.off("clearGameChanges.VW",this.clearViewportProperty),this.player.off("applyNodeChanges.B",this.applyMoveProperty),this.player.off("applyNodeChanges.W",this.applyMoveProperty),this.player.off("board.addTemporaryObject",this.addTemporaryBoardObject),this.player.off("board.removeTemporaryObject",this.removeTemporaryBoardObject),this.player.off("board.updateTemporaryObject",this.updateTemporaryBoardObject),this.player.off("board.setCoordinates",this.setCoordinates)},i.prototype.updateStones=function(){var e=this;this.stoneBoardsObjects=this.stoneBoardsObjects.filter((function(t){return e.player.game.getStone(t.x,t.y)===se[t.type]||(e.board.removeObject(t),!1)}));for(var r=this.player.game.position,i=function(e){for(var i=function(i){var n=r.get(e,i);if(n&&!o.stoneBoardsObjects.some((function(t){return t.x===e&&t.y===i&&n===se[t.type]}))){var s=new u(n===t.Color.B?"B":"W",e,i);o.board.addObject(s),o.stoneBoardsObjects.push(s)}},n=0;n<r.size;n++)i(n)},o=this,n=0;n<r.size;n++)i(n)},i.prototype.addVariationMarkup=function(){var t=this,e=this.player.getVariations();e.length>1&&(e.forEach((function(e,r){if(e){var i=new ne(String.fromCodePoint(65+r),e.x,e.y);i.handler=t.player.config.variationDrawHandler,t.addTemporaryBoardObject(i)}})),null!=this.boardMouseX&&this.handleVariationCursor(this.boardMouseX,this.boardMouseY,e))},i.prototype.clearTemporaryBoardObjects=function(){this.temporaryBoardObjects.length&&(this.board.removeObject(this.temporaryBoardObjects),this.temporaryBoardObjects=[])},i.prototype.handleBoardClick=function(t){this.player.emit("boardClick",t);var e=this.player.getVariations();if(e.length>1){var r=e.findIndex((function(e){return e&&e.x===t.x&&e.y===t.y}));r>=0&&(this.player.shouldShowCurrentVariations()?(this.player.previous(),this.player.next(r)):this.player.next(r))}},i.prototype.handleBoardMouseMove=function(t){this.player.emit("boardMouseMove",t),this.handleVariationCursor(t.x,t.y,this.player.getVariations())},i.prototype.handleBoardMouseOut=function(){this.player.emit("boardMouseOut"),this.removeVariationCursor()},i.prototype.handleVariationCursor=function(t,e,r){r.length>1&&r.findIndex((function(r){return r&&r.x===t&&r.y===e}))>=0?this.boardElement.style.cursor="pointer":this.removeVariationCursor()},i.prototype.removeVariationCursor=function(){this.boardElement.style.cursor&&(this.boardElement.style.cursor="")},i.prototype.applyNodeChanges=function(){this.updateStones(),this.addVariationMarkup()},i.prototype.clearNodeChanges=function(){this.clearTemporaryBoardObjects(),this.removeVariationCursor()},i.prototype.applyMarkupProperty=function(t){var e=this;t.value.forEach((function(r){var i=new d(t.propIdent,e.player.game.getStone(r.x,r.y));i.zIndex=10,i.setPosition(r.x,r.y),e.addTemporaryBoardObject(i)}))},i.prototype.applyLabelMarkupProperty=function(t){var e=this;t.value.forEach((function(t){var r=new f(t.text,e.player.game.getStone(t.x,t.y));r.zIndex=10,r.setPosition(t.x,t.y),e.addTemporaryBoardObject(r)}))},i.prototype.applyLineMarkupProperty=function(t){var e=this;t.value.forEach((function(r){var i=new m(t.propIdent,r[0],r[1]);i.zIndex=10,e.addTemporaryBoardObject(i)}))},i.prototype.applyViewportProperty=function(t){var e=this.board.getViewport();if(this.viewportStack.push(e),t.value){var r=Math.min(t.value[0].x,t.value[1].x),i=Math.min(t.value[0].y,t.value[1].y),o=Math.max(t.value[0].x,t.value[1].x),n=Math.max(t.value[0].y,t.value[1].y);this.board.setViewport({left:r,top:i,right:this.board.getSize()-o-1,bottom:this.board.getSize()-n-1})}else this.board.setViewport({top:0,right:0,bottom:0,left:0})},i.prototype.clearViewportProperty=function(){var t=this.viewportStack.pop();t&&this.board.setViewport(t)},i.prototype.applyMoveProperty=function(t){if(this.player.config.highlightCurrentMove){if(!t.value)return;if(le(t.value,this.player.currentNode.properties))return;if(this.player.getVariations().length>1&&this.player.shouldShowCurrentVariations())return;var e=new oe("B"===t.propIdent?this.player.config.currentMoveBlackMark:this.player.config.currentMoveWhiteMark,t.value.x,t.value.y);e.zIndex=10,this.addTemporaryBoardObject(e)}},i.prototype.addTemporaryBoardObject=function(t){this.temporaryBoardObjects.push(t),this.board.addObject(t)},i.prototype.removeTemporaryBoardObject=function(t){this.temporaryBoardObjects=this.temporaryBoardObjects.filter((function(e){return e!==t})),this.board.removeObject(t)},i.prototype.updateTemporaryBoardObject=function(t){this.board.updateObject(t)},i.prototype.setCoordinates=function(t){this.player.coordinates=t,this.board.setCoordinates(t)},i}(ie);function he(t,e){return e&&t.x===e.x&&t.y===e.y}function le(t,e){for(var r=Object.keys(e),i=0;i<r.length;i++)if("B"!==r[i]&&"W"!==r[i]){var o=e[r[i]];if(Array.isArray(o)){for(var n=0;n<o.length;n++)if(he(t,o[n]))return!0}else if(he(t,o))return!0}return!1}var pe=function(t){function e(e){var r=t.call(this)||this;return r.children=[],r.items=e.items,r.direction=e.direction,r.handleResize=r.handleResize.bind(r),r}return r(e,t),e.prototype.create=function(t){return this.player=t,this.element=document.createElement("div"),this.element.className="wgo-player__container wgo-player__container--"+this.direction,t.on("resize",this.handleResize),this.element},e.prototype.didMount=function(t){var e=this;this.items.forEach((function(r){if(!r.condition||r.condition(e)){var i=new r.component(r.params);e.element.appendChild(i.create(t)),i.didMount(t),e.children.push(i)}else e.children.push(null)}))},e.prototype.destroy=function(t){var e=this;this.children.forEach((function(r){r&&(r.destroy(t),e.element.removeChild(e.element.firstChild))})),t.off("resize",this.handleResize)},e.prototype.handleResize=function(){var t=this,e=0;this.items.forEach((function(r,i){if(!r.condition||r.condition(t)){if(null==t.children[i]){var o=new r.component(r.params);t.element.insertBefore(o.create(t.player),t.element.children[e]),o.didMount(t.player),t.children[i]=o}e++}else t.children[i]&&(t.children[i].destroy(t.player),t.children[i]=null,t.element.removeChild(t.element.children[e]))}))},e}(ie),ce=function(e){function i(r){var i=e.call(this)||this;return i.color=r,i.colorChar=r===t.Color.B?"B":"W",i.colorName=r===t.Color.B?"black":"white",i.setName=i.setName.bind(i),i.setRank=i.setRank.bind(i),i.setTeam=i.setTeam.bind(i),i.setCaps=i.setCaps.bind(i),i}return r(i,e),i.prototype.create=function(t){this.player=t,this.element=document.createElement("div"),this.element.className="wgo-player__box wgo-player__player-tag";var e=document.createElement("div");return e.className="wgo-player__player-tag__name",this.element.appendChild(e),this.playerNameElement=document.createElement("span"),e.appendChild(this.playerNameElement),this.playerRankElement=document.createElement("small"),this.playerRankElement.className="wgo-player__player-tag__name__rank",e.appendChild(this.playerRankElement),this.playerCapsElement=document.createElement("div"),this.playerCapsElement.className="wgo-player__player-tag__color wgo-player__player-tag__color--"+this.colorName,this.playerCapsElement.textContent="0",this.element.appendChild(this.playerCapsElement),this.playerTeamElement=document.createElement("div"),this.player.on("beforeInit.P"+this.colorChar,this.setName),this.player.on("beforeInit."+this.colorChar+"R",this.setRank),this.player.on("beforeInit."+this.colorChar+"T",this.setTeam),this.player.on("applyNodeChanges",this.setCaps),this.initialSet(),this.element},i.prototype.destroy=function(){this.player.off("beforeInit.P"+this.colorChar,this.setName),this.player.off("beforeInit."+this.colorChar+"R",this.setRank),this.player.off("beforeInit."+this.colorChar+"T",this.setTeam),this.player.off("applyNodeChanges",this.setCaps)},i.prototype.setName=function(t){this.playerNameElement.textContent=t.value},i.prototype.setRank=function(t){this.playerRankElement.textContent=t.value},i.prototype.setTeam=function(t){this.playerTeamElement.textContent=t.value},i.prototype.setCaps=function(){this.playerCapsElement.textContent=this.player.game.position.capCount[this.colorName].toString()},i.prototype.initialSet=function(){this.player.rootNode&&(this.playerNameElement.textContent=this.player.rootNode.getProperty("P"+this.colorChar)||"",this.playerRankElement.textContent=this.player.rootNode.getProperty(this.colorChar+"R")||"",this.playerTeamElement.textContent=this.player.rootNode.getProperty(this.colorChar+"T")||""),this.player.game&&this.setCaps()},i}(ie),ue=function(t){function e(){var e=t.call(this)||this;return e.setComments=e.setComments.bind(e),e.clearComments=e.clearComments.bind(e),e}return r(e,t),e.prototype.create=function(t){this.player=t,this.element=document.createElement("div"),this.element.className="wgo-player__box wgo-player__box--content wgo-player__box--stretch";var e=document.createElement("div");if(e.innerHTML="Comments",e.className="wgo-player__box__title",this.element.appendChild(e),this.commentsElement=document.createElement("div"),this.commentsElement.className="wgo-player__box__content",this.element.appendChild(this.commentsElement),this.player.on("applyNodeChanges.C",this.setComments),this.player.on("clearNodeChanges.C",this.clearComments),this.player.currentNode){var r=this.player.currentNode.getProperty("C");r&&this.setComments({value:r})}return this.element},e.prototype.destroy=function(){this.player.off("applyNodeChanges.C",this.setComments),this.player.off("clearNodeChanges.C",this.clearComments)},e.prototype.setComments=function(t){var e=this;this.commentsElement.innerHTML=this.formatComment(t.value),this.player.config.formatMoves&&[].forEach.call(this.commentsElement.querySelectorAll(".wgo-player__move-link"),(function(t){var r=new d("MA");r.zIndex=20,t.addEventListener("mouseenter",(function(){var i=de(t.textContent);r.setPosition(i.x,i.y),e.player.emit("board.addTemporaryObject",r)})),t.addEventListener("mouseleave",(function(){e.player.emit("board.removeTemporaryObject",r)}))}))},e.prototype.clearComments=function(){this.commentsElement.textContent=""},e.prototype.formatComment=function(t){var e=t.replace(/</g,"&lt;").replace(/>/g,"&gt;");return e="<p>"+e.replace(/\n/g,"</p><p>")+"</p>",this.player.config.formatNicks&&(e=e.replace(/(<p>)([^:]{3,}:)\s/g,'<p><span class="wgo-player__nick">$2</span> ')),this.player.config.formatMoves&&(e=e.replace(/\b[a-zA-Z]1?\d\b/g,'<a href="javascript:void(0)" class="wgo-player__move-link">$&</a>')),e},e}(ie);function de(t){return{x:t.toLowerCase().charCodeAt(0)-97,y:parseInt(t.substr(1),10)-1}}var fe={DT:"Date",KM:"Komi",HA:"Handicap",AN:"Annotations",CP:"Copyright",GC:"Game comments",GN:"Game name",ON:"Fuseki",OT:"Overtime",TM:"Basic time",RE:"Result",RO:"Round",RU:"Rules",US:"Recorder",PC:"Place",EV:"Event",SO:"Source"},me=function(t){function e(){var e=t.call(this)||this;return e.printInfo=e.printInfo.bind(e),e}return r(e,t),e.prototype.create=function(t){this.player=t,this.element=document.createElement("div"),this.element.className="wgo-player__box wgo-player__box--content";var e=document.createElement("div");return e.innerHTML="Game information",e.className="wgo-player__box__title",this.element.appendChild(e),this.infoTable=document.createElement("table"),this.infoTable.className="wgo-player__box__game-info",this.element.appendChild(this.infoTable),this.player.on("beforeInit",this.printInfo),this.printInfo(),this.element},e.prototype.destroy=function(){this.player.off("beforeInit",this.printInfo)},e.prototype.addInfo=function(t,e){var r=document.createElement("tr");r.dataset.propIdent=t,this.infoTable.appendChild(r);var i=document.createElement("th");i.textContent=fe[t],r.appendChild(i);var o=document.createElement("td");o.textContent=e,r.appendChild(o)},e.prototype.removeInfo=function(t){var e=this.infoTable.querySelector("[data-id='"+t+"']");this.infoTable.removeChild(e)},e.prototype.printInfo=function(){var t=this;this.infoTable.innerHTML="",this.player.rootNode&&this.player.rootNode.forEachProperty((function(e,r){fe[e]&&t.addInfo(e,r)}))},e}(ie),ye=function(t){function e(){var e=t.call(this)||this;return e.update=e.update.bind(e),e}return r(e,t),e.prototype.create=function(t){var e=this;this.player=t,this.element=document.createElement("div"),this.element.className="wgo-player__control-panel";var r=document.createElement("form");r.className="wgo-player__button-group",this.element.appendChild(r),r.addEventListener("submit",(function(t){t.preventDefault(),e.player.goTo(parseInt(e.moveNumber.value,10))})),this.first=document.createElement("button"),this.first.type="button",this.first.className="wgo-player__button",this.first.innerHTML='<span class="wgo-player__icon-to-end wgo-player__icon--reverse"></span>',this.first.addEventListener("click",(function(){return e.player.first()})),r.appendChild(this.first),this.previous=document.createElement("button"),this.previous.type="button",this.previous.className="wgo-player__button",this.previous.innerHTML='<span class="wgo-player__icon-play wgo-player__icon--reverse"></span>',this.previous.addEventListener("click",(function(){return e.player.previous()})),r.appendChild(this.previous),this.moveNumber=document.createElement("input"),this.moveNumber.className="wgo-player__button wgo-player__move-number",this.moveNumber.value="0",this.moveNumber.addEventListener("blur",(function(t){e.player.goTo(parseInt(e.moveNumber.value,10))})),r.appendChild(this.moveNumber),this.next=document.createElement("button"),this.next.type="button",this.next.className="wgo-player__button",this.next.innerHTML='<span class="wgo-player__icon-play"></span>',this.next.addEventListener("click",(function(){return e.player.next()})),r.appendChild(this.next),this.last=document.createElement("button"),this.last.type="button",this.last.className="wgo-player__button",this.last.innerHTML='<span class="wgo-player__icon-to-end"></span>',this.last.addEventListener("click",(function(){return e.player.last()})),r.appendChild(this.last);var i=document.createElement("div");i.className="wgo-player__menu-wrapper",this.element.appendChild(i);var o=document.createElement("button");o.type="button",o.className="wgo-player__button wgo-player__button--menu",o.innerHTML='<span class="wgo-player__icon-menu"></span>',i.appendChild(o);var n=document.createElement("div");return n.className="wgo-player__menu",this.createMenuItems(n),i.appendChild(n),this.player.on("applyNodeChanges",this.update),this.player.currentNode&&this.update(),this.element},e.prototype.destroy=function(){this.player.off("applyNodeChanges",this.update)},e.prototype.update=function(){this.moveNumber.value=String(this.player.getCurrentPath().depth),this.player.currentNode.parent?(this.first.disabled=!1,this.previous.disabled=!1):(this.first.disabled=!0,this.previous.disabled=!0),0===this.player.currentNode.children.length?(this.next.disabled=!0,this.last.disabled=!0):(this.next.disabled=!1,this.last.disabled=!1)},e.prototype.createMenuItems=function(t){var r=this;e.menuItems.forEach((function(e){var i=document.createElement("a");i.className="wgo-player__menu-item",i.tabIndex=0,i.textContent=e.name,i.href="javascript: void(0)",e.checkable&&e.defaultChecked&&e.defaultChecked.call(r)&&(i.className+=" wgo-player__menu-item--checked"),i.addEventListener("click",(function(t){t.preventDefault();var o=e.fn.call(r);e.checkable&&(i.className=o?"wgo-player__menu-item wgo-player__menu-item--checked":"wgo-player__menu-item"),i.blur()})),t.appendChild(i)}))},e.menuItems=[{name:"Edit mode",fn:function(){return this.player.setEditMode(!this.player.editMode),this.player.editMode},checkable:!0,defaultChecked:function(){return this.player.editMode}},{name:"Display coordinates",fn:function(){return this.player.emit("board.setCoordinates",!this.player.coordinates),this.player.coordinates},checkable:!0,defaultChecked:function(){return!1}},{name:"Download SGF",fn:function(){be(this.player.rootNode.getProperty(Ft.GAME_NAME)||"game",this.player.rootNode.toSGF())}}],e}(ie);function be(t,e){var r=document.createElement("a");r.setAttribute("href","data:application/x-go-sgf;charset=utf-8,"+encodeURIComponent(e)),r.setAttribute("download",t+".sgf"),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}var ge={minWidth:function(t){return function(e){return e.element.offsetWidth>=t}},minHeight:function(t){return function(e){return e.element.offsetHeight>=t}},maxWidth:function(t){return function(e){return e.element.offsetWidth<=t}},maxHeight:function(t){return function(e){return e.element.offsetHeight<=t}},and:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return t.every((function(t){return t(e)}))}},or:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return t.some((function(t){return t(e)}))}}},ve=function(e){function i(t,r){void 0===r&&(r={});var i=e.call(this)||this;return i.element=t,i.config=b(re,r),i.init(),i}return r(i,e),i.prototype.init=function(){var e=this;this.editMode=!1,this.mainElement=document.createElement("div"),this.mainElement.className="wgo-player",this.mainElement.tabIndex=1,this.element.appendChild(this.mainElement),document.addEventListener("mousewheel",this._mouseWheelEvent=function(t){if(document.activeElement===e.mainElement&&e.config.enableMouseWheel)return t.deltaY>0?e.next():t.deltaY<0&&e.previous(),!1}),document.addEventListener("keydown",this._keyEvent=function(t){if(document.activeElement===e.mainElement&&e.config.enableKeys)return"ArrowRight"===t.key?e.next():"ArrowLeft"===t.key&&e.previous(),!1}),window.addEventListener("resize",this._resizeEvent=function(t){return e.resize()}),this.layout=new pe({direction:"column",items:[{component:pe,condition:ge.maxWidth(749),params:{direction:"row",items:[{component:ce,params:t.Color.B},{component:ce,params:t.Color.W}]}},{component:pe,params:{direction:"row",items:[{component:ae},{component:pe,condition:ge.minWidth(650),params:{direction:"column",items:[{component:ce,params:t.Color.B,condition:ge.minWidth(250)},{component:ce,params:t.Color.W,condition:ge.minWidth(250)},{component:ye,condition:ge.minWidth(250)},{component:me},{component:ue}]}}]}},{component:ye,condition:ge.maxWidth(749)},{component:ue,condition:ge.maxWidth(649)}]}),this.mainElement.appendChild(this.layout.create(this)),this.layout.didMount(this)},i.prototype.destroy=function(){document.removeEventListener("mousewheel",this._mouseWheelEvent),this._mouseWheelEvent=null,document.removeEventListener("keydown",this._keyEvent),this._keyEvent=null,window.removeEventListener("resize",this._resizeEvent),this._resizeEvent=null},i.prototype.getVariations=function(){if(this.shouldShowVariations()){if(!this.shouldShowCurrentVariations())return this.currentNode.children.map((function(t){return t.getProperty("B")||t.getProperty("W")}));if(this.currentNode.parent)return this.currentNode.parent.children.map((function(t){return t.getProperty("B")||t.getProperty("W")}))}return[]},i.prototype.shouldShowVariations=function(){var t=this.rootNode.getProperty(Ft.VARIATIONS_STYLE);return null!=t?!(2&t):this.config.showVariations},i.prototype.shouldShowCurrentVariations=function(){if(this.editMode)return!1;var t=this.rootNode.getProperty(Ft.VARIATIONS_STYLE);return null!=t?!!(1&t):this.config.showCurrentVariations},i.prototype.resize=function(){this.emit("resize",this)},i.prototype.setEditMode=function(e){var r=this;if(e&&!this.editMode){this.save(),this.editMode=!0;var i=-1,o=-1,n=new u("B");n.opacity=.35;var s=new u("W");s.opacity=.35;var a=null;this._boardMouseMoveEvent=function(e){if(i!==e.x||o!==e.y){if(r.game.isValid(e.x,e.y)){var h=r.game.turn===t.Color.BLACK?n:s;h.setPosition(e.x,e.y),a?r.emit("board.updateTemporaryObject",h):(r.emit("board.addTemporaryObject",h),a=h)}else r._boardMouseOutEvent();i=e.x,o=e.y}},this._boardMouseOutEvent=function(){a&&(r.emit("board.removeTemporaryObject",a),a=null),i=-1,o=-1},this._boardClickEvent=function(t){if(r._boardMouseOutEvent(),null!=t){for(var e=0;e<r.currentNode.children.length;e++){var i=r.currentNode.children[e].getProperty("B")||r.currentNode.children[e].getProperty("W");if(i.x===t.x&&i.y===t.y)return void r.next(e)}r.game.isValid(t.x,t.y)&&r.play(t.x,t.y)}},this._nodeChange=function(){var t={x:i,y:o};r._boardMouseOutEvent(),r._boardMouseMoveEvent(t)},this.on("boardMouseMove",this._boardMouseMoveEvent),this.on("boardMouseOut",this._boardMouseOutEvent),this.on("boardClick",this._boardClickEvent),this.on("applyNodeChanges",this._nodeChange)}else!e&&this.editMode&&(this.off("boardMouseMove",this._boardMouseMoveEvent),this.off("boardMouseOut",this._boardMouseOutEvent),this.off("boardClick",this._boardClickEvent),this.off("applyNodeChanges",this._nodeChange),this.editMode=!1,this.restore())},i}(ee);t.BoardBase=C,t.BoardLabelObject=f,t.BoardLineObject=m,t.BoardMarkupObject=d,t.BoardObject=c,t.CHINESE_RULES=Ot,t.CanvasBoard=$,t.CommentBox=ue,t.Component=ie,t.Container=pe,t.ContainerCondition=ge,t.ControlPanel=ye,t.FieldObject=u,t.Game=Bt,t.GameInfoBox=me,t.ING_RULES=Pt,t.JAPANESE_RULES=kt,t.KifuNode=Ut,t.NO_RULES=_t,t.PlayerBase=ee,t.PlayerTag=ce,t.Position=Lt,t.SGFParser=p,t.SGFSyntaxError=o,t.SVGBoard=Mt,t.SVGBoardComponent=ae,t.SimplePlayer=ve,t.drawHandlers=K,t.goRules=Tt,t.propertyValueTypes=Dt,t.themes=J,Object.defineProperty(t,"__esModule",{value:!0})}(e)}}]);
//# sourceMappingURL=21.25f72e90.chunk.js.map